
                (function() {
                    var nodeEnv = typeof require !== 'undefined' && typeof process !== 'undefined';
                    var __module = nodeEnv ? module : {exports:{}};
                    var __filename = 'preview-scripts/assets/newscripts/Level/LvTarget.js';
                    var __require = nodeEnv ? function (request) {
                        return cc.require(request);
                    } : function (request) {
                        return __quick_compile_project__.require(request, __filename);
                    };
                    function __define (exports, require, module) {
                        if (!nodeEnv) {__quick_compile_project__.registerModule(__filename, module);}"use strict";
cc._RF.push(module, 'd4a64saYolB6ISDmMqYVnxn', 'LvTarget');
// newscripts/Level/LvTarget.js

"use strict";

var _require = require('../UIHelp'),
    UIHelp = _require.UIHelp;

cc.Class({
  "extends": cc.Component,
  properties: {
    //关卡显示框
    lvLabel: cc.Label,
    //要玩第几关关
    lv: 1,
    //目标
    target: [cc.Sprite],
    //精力图标
    energy: cc.Node,
    energylogo: cc.Node,
    //tip
    tip: cc.Prefab,
    music: {
      type: cc.AudioClip,
      "default": []
    }
  },
  onLoad: function onLoad() {
    cc.ZL.Target = this;
    this.energylogo.opacity = 0;
  },
  start: function start() {},
  // update (dt) {},
  InitView: function InitView(num) {
    if (gamedata.music) {
      cc.audioEngine.play(this.music[0], false, 1);
    }

    this.lv = num, comeInfo.now_lv = num;
    cc.ZL.Level.OpenMask();
    this.lvLabel.string = '第' + this.lv + '关'; // let T=lvdata["Lv"+comeInfo.now_lv].target;

    var T = lvdata.target;

    for (var i = 0; i < this.target.length; i++) {
      if (i < T.length) {
        if (T[i][0] < 10) {
          this.target[i].spriteFrame = cc.ZL.sprMgr.spr[T[i][0]];
        } else {
          this.target[i].spriteFrame = cc.ZL.sprMgr.icespr[T[i][0] - 10];
        }

        this.target[i].node.active = true;
      } else {
        this.target[i].node.active = false;
      }
    }

    var y = cc.find('Canvas').height / 2 - this.node.height / 2;
    this.node.runAction(cc.moveTo(0.2, cc.v2(0, y), 0).easing(cc.easeBackOut()));
  },
  close: function close() {
    if (gamedata.music) {
      cc.audioEngine.play(this.music[0], false, 1);
    }

    cc.ZL.Level.closeMask();
    this.energylogo.opacity = 0;
    this.node.runAction(cc.moveTo(0.2, 0, 2000));
  },
  //开始游戏
  BeginGame: function BeginGame() {
    console.log('BeginGame');

    if (gamedata.energy < 5) {
      var a = cc.instantiate(this.tip);
      this.node.parent.addChild(a);
      a.getComponent('tip').InitView(2);
      return;
    }

    if (gamedata.music) {
      cc.audioEngine.play(this.music[1], false, 1);
    }

    var preas = {
      rid: gamedata.rid,
      token: gamedata.token,
      level: this.lv
    }; // TODO:先注释

    this.playGameCall({
      code: '200',
      data: {
        coin: '10',
        energy: '10'
      }
    }); // UIHelp.network.httpSend('game/xiaoxiaole/playGame', preas, this.playGameCall.bind(this));
    // gamedata.energy -=5;
    // gamedata.bc_energy();
    // //获取到精力图标的位置
    // var pos=this.energy.parent.convertToWorldSpaceAR(this.energy.getPosition());
    // //转换到父物体的位置
    // var pos1=this.energylogo.parent.convertToNodeSpaceAR(pos);
    // this.energylogo.setPosition(pos1);
    // this.energylogo.opacity=255;
    // this.energylogo.runAction(cc.moveTo(0.5,27,-358));
    // setTimeout(function(){
    //     if(gamedata.music){
    //         cc.audioEngine.play(this.music[2],false,1);
    //     }
    //     //cc.ZL.lvMgr.MyplayMusic(2,false);
    //     cc.director.loadScene("NewMain");
    // }.bind(this),600);
  },
  playGameCall: function playGameCall(msg) {
    console.log('playgame===>', msg);

    if (msg.code == 200) {
      gamedata.game_code = msg.data.game_code; // gamedata.energy -= 5;
      // gamedata.bc_energy();
      //当前金币数量

      gamedata.gold = Number(msg.data.coin); //当前精力

      gamedata.energy = Number(msg.data.energy); //获取到精力图标的位置

      var pos = this.energy.parent.convertToWorldSpaceAR(this.energy.getPosition()); //转换到父物体的位置

      var pos1 = this.energylogo.parent.convertToNodeSpaceAR(pos);
      this.energylogo.setPosition(pos1);
      this.energylogo.opacity = 255;
      this.energylogo.runAction(cc.moveTo(0.5, 27, -358));
      setTimeout(function () {
        if (gamedata.music) {
          cc.audioEngine.play(this.music[2], false, 1);
        } //cc.ZL.lvMgr.MyplayMusic(2,false);


        cc.director.loadScene('NewMain');
      }.bind(this), 600);
    } else {
      utils.addTips(msg.message);
    }
  }
});

cc._RF.pop();
                    }
                    if (nodeEnv) {
                        __define(__module.exports, __require, __module);
                    }
                    else {
                        __quick_compile_project__.registerModuleFunc(__filename, function () {
                            __define(__module.exports, __require, __module);
                        });
                    }
                })();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFzc2V0cy9uZXdzY3JpcHRzL0xldmVsL0x2VGFyZ2V0LmpzIl0sIm5hbWVzIjpbInJlcXVpcmUiLCJVSUhlbHAiLCJjYyIsIkNsYXNzIiwiQ29tcG9uZW50IiwicHJvcGVydGllcyIsImx2TGFiZWwiLCJMYWJlbCIsImx2IiwidGFyZ2V0IiwiU3ByaXRlIiwiZW5lcmd5IiwiTm9kZSIsImVuZXJneWxvZ28iLCJ0aXAiLCJQcmVmYWIiLCJtdXNpYyIsInR5cGUiLCJBdWRpb0NsaXAiLCJvbkxvYWQiLCJaTCIsIlRhcmdldCIsIm9wYWNpdHkiLCJzdGFydCIsIkluaXRWaWV3IiwibnVtIiwiZ2FtZWRhdGEiLCJhdWRpb0VuZ2luZSIsInBsYXkiLCJjb21lSW5mbyIsIm5vd19sdiIsIkxldmVsIiwiT3Blbk1hc2siLCJzdHJpbmciLCJUIiwibHZkYXRhIiwiaSIsImxlbmd0aCIsInNwcml0ZUZyYW1lIiwic3ByTWdyIiwic3ByIiwiaWNlc3ByIiwibm9kZSIsImFjdGl2ZSIsInkiLCJmaW5kIiwiaGVpZ2h0IiwicnVuQWN0aW9uIiwibW92ZVRvIiwidjIiLCJlYXNpbmciLCJlYXNlQmFja091dCIsImNsb3NlIiwiY2xvc2VNYXNrIiwiQmVnaW5HYW1lIiwiY29uc29sZSIsImxvZyIsImEiLCJpbnN0YW50aWF0ZSIsInBhcmVudCIsImFkZENoaWxkIiwiZ2V0Q29tcG9uZW50IiwicHJlYXMiLCJyaWQiLCJ0b2tlbiIsImxldmVsIiwicGxheUdhbWVDYWxsIiwiY29kZSIsImRhdGEiLCJjb2luIiwibXNnIiwiZ2FtZV9jb2RlIiwiZ29sZCIsIk51bWJlciIsInBvcyIsImNvbnZlcnRUb1dvcmxkU3BhY2VBUiIsImdldFBvc2l0aW9uIiwicG9zMSIsImNvbnZlcnRUb05vZGVTcGFjZUFSIiwic2V0UG9zaXRpb24iLCJzZXRUaW1lb3V0IiwiZGlyZWN0b3IiLCJsb2FkU2NlbmUiLCJiaW5kIiwidXRpbHMiLCJhZGRUaXBzIiwibWVzc2FnZSJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7ZUFBbUJBLE9BQU8sQ0FBQyxXQUFEO0lBQWxCQyxrQkFBQUE7O0FBQ1JDLEVBQUUsQ0FBQ0MsS0FBSCxDQUFTO0FBQ0wsYUFBU0QsRUFBRSxDQUFDRSxTQURQO0FBRUxDLEVBQUFBLFVBQVUsRUFBRTtBQUNSO0FBQ0FDLElBQUFBLE9BQU8sRUFBRUosRUFBRSxDQUFDSyxLQUZKO0FBR1I7QUFDQUMsSUFBQUEsRUFBRSxFQUFFLENBSkk7QUFLUjtBQUNBQyxJQUFBQSxNQUFNLEVBQUUsQ0FBQ1AsRUFBRSxDQUFDUSxNQUFKLENBTkE7QUFPUjtBQUNBQyxJQUFBQSxNQUFNLEVBQUVULEVBQUUsQ0FBQ1UsSUFSSDtBQVNSQyxJQUFBQSxVQUFVLEVBQUVYLEVBQUUsQ0FBQ1UsSUFUUDtBQVVSO0FBQ0FFLElBQUFBLEdBQUcsRUFBRVosRUFBRSxDQUFDYSxNQVhBO0FBWVJDLElBQUFBLEtBQUssRUFBRTtBQUNIQyxNQUFBQSxJQUFJLEVBQUVmLEVBQUUsQ0FBQ2dCLFNBRE47QUFFSCxpQkFBUztBQUZOO0FBWkMsR0FGUDtBQW1CTEMsRUFBQUEsTUFuQkssb0JBbUJJO0FBQ0xqQixJQUFBQSxFQUFFLENBQUNrQixFQUFILENBQU1DLE1BQU4sR0FBZSxJQUFmO0FBQ0EsU0FBS1IsVUFBTCxDQUFnQlMsT0FBaEIsR0FBMEIsQ0FBMUI7QUFDSCxHQXRCSTtBQXdCTEMsRUFBQUEsS0F4QkssbUJBd0JHLENBQUUsQ0F4Qkw7QUEwQkw7QUFDQUMsRUFBQUEsUUEzQkssb0JBMkJJQyxHQTNCSixFQTJCUztBQUNWLFFBQUlDLFFBQVEsQ0FBQ1YsS0FBYixFQUFvQjtBQUNoQmQsTUFBQUEsRUFBRSxDQUFDeUIsV0FBSCxDQUFlQyxJQUFmLENBQW9CLEtBQUtaLEtBQUwsQ0FBVyxDQUFYLENBQXBCLEVBQW1DLEtBQW5DLEVBQTBDLENBQTFDO0FBQ0g7O0FBQ0EsU0FBS1IsRUFBTCxHQUFVaUIsR0FBWCxFQUFrQkksUUFBUSxDQUFDQyxNQUFULEdBQWtCTCxHQUFwQztBQUNBdkIsSUFBQUEsRUFBRSxDQUFDa0IsRUFBSCxDQUFNVyxLQUFOLENBQVlDLFFBQVo7QUFDQSxTQUFLMUIsT0FBTCxDQUFhMkIsTUFBYixHQUFzQixNQUFNLEtBQUt6QixFQUFYLEdBQWdCLEdBQXRDLENBTlUsQ0FPVjs7QUFDQSxRQUFJMEIsQ0FBQyxHQUFHQyxNQUFNLENBQUMxQixNQUFmOztBQUNBLFNBQUssSUFBSTJCLENBQUMsR0FBRyxDQUFiLEVBQWdCQSxDQUFDLEdBQUcsS0FBSzNCLE1BQUwsQ0FBWTRCLE1BQWhDLEVBQXdDRCxDQUFDLEVBQXpDLEVBQTZDO0FBQ3pDLFVBQUlBLENBQUMsR0FBR0YsQ0FBQyxDQUFDRyxNQUFWLEVBQWtCO0FBQ2QsWUFBSUgsQ0FBQyxDQUFDRSxDQUFELENBQUQsQ0FBSyxDQUFMLElBQVUsRUFBZCxFQUFrQjtBQUNkLGVBQUszQixNQUFMLENBQVkyQixDQUFaLEVBQWVFLFdBQWYsR0FBNkJwQyxFQUFFLENBQUNrQixFQUFILENBQU1tQixNQUFOLENBQWFDLEdBQWIsQ0FBaUJOLENBQUMsQ0FBQ0UsQ0FBRCxDQUFELENBQUssQ0FBTCxDQUFqQixDQUE3QjtBQUNILFNBRkQsTUFFTztBQUNILGVBQUszQixNQUFMLENBQVkyQixDQUFaLEVBQWVFLFdBQWYsR0FBNkJwQyxFQUFFLENBQUNrQixFQUFILENBQU1tQixNQUFOLENBQWFFLE1BQWIsQ0FBb0JQLENBQUMsQ0FBQ0UsQ0FBRCxDQUFELENBQUssQ0FBTCxJQUFVLEVBQTlCLENBQTdCO0FBQ0g7O0FBQ0QsYUFBSzNCLE1BQUwsQ0FBWTJCLENBQVosRUFBZU0sSUFBZixDQUFvQkMsTUFBcEIsR0FBNkIsSUFBN0I7QUFDSCxPQVBELE1BT087QUFDSCxhQUFLbEMsTUFBTCxDQUFZMkIsQ0FBWixFQUFlTSxJQUFmLENBQW9CQyxNQUFwQixHQUE2QixLQUE3QjtBQUNIO0FBQ0o7O0FBQ0QsUUFBSUMsQ0FBQyxHQUFHMUMsRUFBRSxDQUFDMkMsSUFBSCxDQUFRLFFBQVIsRUFBa0JDLE1BQWxCLEdBQTJCLENBQTNCLEdBQStCLEtBQUtKLElBQUwsQ0FBVUksTUFBVixHQUFtQixDQUExRDtBQUNBLFNBQUtKLElBQUwsQ0FBVUssU0FBVixDQUFvQjdDLEVBQUUsQ0FBQzhDLE1BQUgsQ0FBVSxHQUFWLEVBQWU5QyxFQUFFLENBQUMrQyxFQUFILENBQU0sQ0FBTixFQUFTTCxDQUFULENBQWYsRUFBNEIsQ0FBNUIsRUFBK0JNLE1BQS9CLENBQXNDaEQsRUFBRSxDQUFDaUQsV0FBSCxFQUF0QyxDQUFwQjtBQUNILEdBbERJO0FBbURMQyxFQUFBQSxLQW5ESyxtQkFtREc7QUFDSixRQUFJMUIsUUFBUSxDQUFDVixLQUFiLEVBQW9CO0FBQ2hCZCxNQUFBQSxFQUFFLENBQUN5QixXQUFILENBQWVDLElBQWYsQ0FBb0IsS0FBS1osS0FBTCxDQUFXLENBQVgsQ0FBcEIsRUFBbUMsS0FBbkMsRUFBMEMsQ0FBMUM7QUFDSDs7QUFDRGQsSUFBQUEsRUFBRSxDQUFDa0IsRUFBSCxDQUFNVyxLQUFOLENBQVlzQixTQUFaO0FBQ0EsU0FBS3hDLFVBQUwsQ0FBZ0JTLE9BQWhCLEdBQTBCLENBQTFCO0FBQ0EsU0FBS29CLElBQUwsQ0FBVUssU0FBVixDQUFvQjdDLEVBQUUsQ0FBQzhDLE1BQUgsQ0FBVSxHQUFWLEVBQWUsQ0FBZixFQUFrQixJQUFsQixDQUFwQjtBQUNILEdBMURJO0FBMkRMO0FBQ0FNLEVBQUFBLFNBNURLLHVCQTRETztBQUNSQyxJQUFBQSxPQUFPLENBQUNDLEdBQVIsQ0FBWSxXQUFaOztBQUNBLFFBQUk5QixRQUFRLENBQUNmLE1BQVQsR0FBa0IsQ0FBdEIsRUFBeUI7QUFDckIsVUFBSThDLENBQUMsR0FBR3ZELEVBQUUsQ0FBQ3dELFdBQUgsQ0FBZSxLQUFLNUMsR0FBcEIsQ0FBUjtBQUNBLFdBQUs0QixJQUFMLENBQVVpQixNQUFWLENBQWlCQyxRQUFqQixDQUEwQkgsQ0FBMUI7QUFDQUEsTUFBQUEsQ0FBQyxDQUFDSSxZQUFGLENBQWUsS0FBZixFQUFzQnJDLFFBQXRCLENBQStCLENBQS9CO0FBQ0E7QUFDSDs7QUFDRCxRQUFJRSxRQUFRLENBQUNWLEtBQWIsRUFBb0I7QUFDaEJkLE1BQUFBLEVBQUUsQ0FBQ3lCLFdBQUgsQ0FBZUMsSUFBZixDQUFvQixLQUFLWixLQUFMLENBQVcsQ0FBWCxDQUFwQixFQUFtQyxLQUFuQyxFQUEwQyxDQUExQztBQUNIOztBQUVELFFBQUk4QyxLQUFLLEdBQUc7QUFDUkMsTUFBQUEsR0FBRyxFQUFFckMsUUFBUSxDQUFDcUMsR0FETjtBQUVSQyxNQUFBQSxLQUFLLEVBQUV0QyxRQUFRLENBQUNzQyxLQUZSO0FBR1JDLE1BQUFBLEtBQUssRUFBRSxLQUFLekQ7QUFISixLQUFaLENBWlEsQ0FrQlI7O0FBQ0EsU0FBSzBELFlBQUwsQ0FBa0I7QUFDZEMsTUFBQUEsSUFBSSxFQUFFLEtBRFE7QUFFZEMsTUFBQUEsSUFBSSxFQUFFO0FBQ0ZDLFFBQUFBLElBQUksRUFBRSxJQURKO0FBRUYxRCxRQUFBQSxNQUFNLEVBQUU7QUFGTjtBQUZRLEtBQWxCLEVBbkJRLENBMEJSO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSCxHQXhHSTtBQTBHTHVELEVBQUFBLFlBMUdLLHdCQTBHUUksR0ExR1IsRUEwR2E7QUFDZGYsSUFBQUEsT0FBTyxDQUFDQyxHQUFSLENBQVksY0FBWixFQUE0QmMsR0FBNUI7O0FBQ0EsUUFBSUEsR0FBRyxDQUFDSCxJQUFKLElBQVksR0FBaEIsRUFBcUI7QUFDakJ6QyxNQUFBQSxRQUFRLENBQUM2QyxTQUFULEdBQXFCRCxHQUFHLENBQUNGLElBQUosQ0FBU0csU0FBOUIsQ0FEaUIsQ0FFakI7QUFDQTtBQUNBOztBQUNBN0MsTUFBQUEsUUFBUSxDQUFDOEMsSUFBVCxHQUFnQkMsTUFBTSxDQUFDSCxHQUFHLENBQUNGLElBQUosQ0FBU0MsSUFBVixDQUF0QixDQUxpQixDQU1qQjs7QUFDQTNDLE1BQUFBLFFBQVEsQ0FBQ2YsTUFBVCxHQUFrQjhELE1BQU0sQ0FBQ0gsR0FBRyxDQUFDRixJQUFKLENBQVN6RCxNQUFWLENBQXhCLENBUGlCLENBUWpCOztBQUNBLFVBQUkrRCxHQUFHLEdBQUcsS0FBSy9ELE1BQUwsQ0FBWWdELE1BQVosQ0FBbUJnQixxQkFBbkIsQ0FBeUMsS0FBS2hFLE1BQUwsQ0FBWWlFLFdBQVosRUFBekMsQ0FBVixDQVRpQixDQVVqQjs7QUFDQSxVQUFJQyxJQUFJLEdBQUcsS0FBS2hFLFVBQUwsQ0FBZ0I4QyxNQUFoQixDQUF1Qm1CLG9CQUF2QixDQUE0Q0osR0FBNUMsQ0FBWDtBQUNBLFdBQUs3RCxVQUFMLENBQWdCa0UsV0FBaEIsQ0FBNEJGLElBQTVCO0FBQ0EsV0FBS2hFLFVBQUwsQ0FBZ0JTLE9BQWhCLEdBQTBCLEdBQTFCO0FBQ0EsV0FBS1QsVUFBTCxDQUFnQmtDLFNBQWhCLENBQTBCN0MsRUFBRSxDQUFDOEMsTUFBSCxDQUFVLEdBQVYsRUFBZSxFQUFmLEVBQW1CLENBQUMsR0FBcEIsQ0FBMUI7QUFDQWdDLE1BQUFBLFVBQVUsQ0FDTixZQUFZO0FBQ1IsWUFBSXRELFFBQVEsQ0FBQ1YsS0FBYixFQUFvQjtBQUNoQmQsVUFBQUEsRUFBRSxDQUFDeUIsV0FBSCxDQUFlQyxJQUFmLENBQW9CLEtBQUtaLEtBQUwsQ0FBVyxDQUFYLENBQXBCLEVBQW1DLEtBQW5DLEVBQTBDLENBQTFDO0FBQ0gsU0FITyxDQUlSOzs7QUFDQWQsUUFBQUEsRUFBRSxDQUFDK0UsUUFBSCxDQUFZQyxTQUFaLENBQXNCLFNBQXRCO0FBQ0gsT0FORCxDQU1FQyxJQU5GLENBTU8sSUFOUCxDQURNLEVBUU4sR0FSTSxDQUFWO0FBVUgsS0F6QkQsTUF5Qk87QUFDSEMsTUFBQUEsS0FBSyxDQUFDQyxPQUFOLENBQWNmLEdBQUcsQ0FBQ2dCLE9BQWxCO0FBQ0g7QUFDSjtBQXhJSSxDQUFUIiwic291cmNlUm9vdCI6Ii8iLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCB7IFVJSGVscCB9ID0gcmVxdWlyZSgnLi4vVUlIZWxwJyk7XHJcbmNjLkNsYXNzKHtcclxuICAgIGV4dGVuZHM6IGNjLkNvbXBvbmVudCxcclxuICAgIHByb3BlcnRpZXM6IHtcclxuICAgICAgICAvL+WFs+WNoeaYvuekuuahhlxyXG4gICAgICAgIGx2TGFiZWw6IGNjLkxhYmVsLFxyXG4gICAgICAgIC8v6KaB546p56ys5Yeg5YWz5YWzXHJcbiAgICAgICAgbHY6IDEsXHJcbiAgICAgICAgLy/nm67moIdcclxuICAgICAgICB0YXJnZXQ6IFtjYy5TcHJpdGVdLFxyXG4gICAgICAgIC8v57K+5Yqb5Zu+5qCHXHJcbiAgICAgICAgZW5lcmd5OiBjYy5Ob2RlLFxyXG4gICAgICAgIGVuZXJneWxvZ286IGNjLk5vZGUsXHJcbiAgICAgICAgLy90aXBcclxuICAgICAgICB0aXA6IGNjLlByZWZhYixcclxuICAgICAgICBtdXNpYzoge1xyXG4gICAgICAgICAgICB0eXBlOiBjYy5BdWRpb0NsaXAsXHJcbiAgICAgICAgICAgIGRlZmF1bHQ6IFtdLFxyXG4gICAgICAgIH0sXHJcbiAgICB9LFxyXG4gICAgb25Mb2FkKCkge1xyXG4gICAgICAgIGNjLlpMLlRhcmdldCA9IHRoaXM7XHJcbiAgICAgICAgdGhpcy5lbmVyZ3lsb2dvLm9wYWNpdHkgPSAwO1xyXG4gICAgfSxcclxuXHJcbiAgICBzdGFydCgpIHt9LFxyXG5cclxuICAgIC8vIHVwZGF0ZSAoZHQpIHt9LFxyXG4gICAgSW5pdFZpZXcobnVtKSB7XHJcbiAgICAgICAgaWYgKGdhbWVkYXRhLm11c2ljKSB7XHJcbiAgICAgICAgICAgIGNjLmF1ZGlvRW5naW5lLnBsYXkodGhpcy5tdXNpY1swXSwgZmFsc2UsIDEpO1xyXG4gICAgICAgIH1cclxuICAgICAgICAodGhpcy5sdiA9IG51bSksIChjb21lSW5mby5ub3dfbHYgPSBudW0pO1xyXG4gICAgICAgIGNjLlpMLkxldmVsLk9wZW5NYXNrKCk7XHJcbiAgICAgICAgdGhpcy5sdkxhYmVsLnN0cmluZyA9ICfnrKwnICsgdGhpcy5sdiArICflhbMnO1xyXG4gICAgICAgIC8vIGxldCBUPWx2ZGF0YVtcIkx2XCIrY29tZUluZm8ubm93X2x2XS50YXJnZXQ7XHJcbiAgICAgICAgbGV0IFQgPSBsdmRhdGEudGFyZ2V0O1xyXG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGhpcy50YXJnZXQubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgaWYgKGkgPCBULmxlbmd0aCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKFRbaV1bMF0gPCAxMCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMudGFyZ2V0W2ldLnNwcml0ZUZyYW1lID0gY2MuWkwuc3ByTWdyLnNwcltUW2ldWzBdXTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy50YXJnZXRbaV0uc3ByaXRlRnJhbWUgPSBjYy5aTC5zcHJNZ3IuaWNlc3ByW1RbaV1bMF0gLSAxMF07XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB0aGlzLnRhcmdldFtpXS5ub2RlLmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnRhcmdldFtpXS5ub2RlLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGxldCB5ID0gY2MuZmluZCgnQ2FudmFzJykuaGVpZ2h0IC8gMiAtIHRoaXMubm9kZS5oZWlnaHQgLyAyO1xyXG4gICAgICAgIHRoaXMubm9kZS5ydW5BY3Rpb24oY2MubW92ZVRvKDAuMiwgY2MudjIoMCwgeSksIDApLmVhc2luZyhjYy5lYXNlQmFja091dCgpKSk7XHJcbiAgICB9LFxyXG4gICAgY2xvc2UoKSB7XHJcbiAgICAgICAgaWYgKGdhbWVkYXRhLm11c2ljKSB7XHJcbiAgICAgICAgICAgIGNjLmF1ZGlvRW5naW5lLnBsYXkodGhpcy5tdXNpY1swXSwgZmFsc2UsIDEpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBjYy5aTC5MZXZlbC5jbG9zZU1hc2soKTtcclxuICAgICAgICB0aGlzLmVuZXJneWxvZ28ub3BhY2l0eSA9IDA7XHJcbiAgICAgICAgdGhpcy5ub2RlLnJ1bkFjdGlvbihjYy5tb3ZlVG8oMC4yLCAwLCAyMDAwKSk7XHJcbiAgICB9LFxyXG4gICAgLy/lvIDlp4vmuLjmiI9cclxuICAgIEJlZ2luR2FtZSgpIHtcclxuICAgICAgICBjb25zb2xlLmxvZygnQmVnaW5HYW1lJyk7XHJcbiAgICAgICAgaWYgKGdhbWVkYXRhLmVuZXJneSA8IDUpIHtcclxuICAgICAgICAgICAgbGV0IGEgPSBjYy5pbnN0YW50aWF0ZSh0aGlzLnRpcCk7XHJcbiAgICAgICAgICAgIHRoaXMubm9kZS5wYXJlbnQuYWRkQ2hpbGQoYSk7XHJcbiAgICAgICAgICAgIGEuZ2V0Q29tcG9uZW50KCd0aXAnKS5Jbml0VmlldygyKTtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoZ2FtZWRhdGEubXVzaWMpIHtcclxuICAgICAgICAgICAgY2MuYXVkaW9FbmdpbmUucGxheSh0aGlzLm11c2ljWzFdLCBmYWxzZSwgMSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBsZXQgcHJlYXMgPSB7XHJcbiAgICAgICAgICAgIHJpZDogZ2FtZWRhdGEucmlkLFxyXG4gICAgICAgICAgICB0b2tlbjogZ2FtZWRhdGEudG9rZW4sXHJcbiAgICAgICAgICAgIGxldmVsOiB0aGlzLmx2LFxyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIC8vIFRPRE865YWI5rOo6YeKXHJcbiAgICAgICAgdGhpcy5wbGF5R2FtZUNhbGwoe1xyXG4gICAgICAgICAgICBjb2RlOiAnMjAwJyxcclxuICAgICAgICAgICAgZGF0YToge1xyXG4gICAgICAgICAgICAgICAgY29pbjogJzEwJyxcclxuICAgICAgICAgICAgICAgIGVuZXJneTogJzEwJyxcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICB9KTtcclxuICAgICAgICAvLyBVSUhlbHAubmV0d29yay5odHRwU2VuZCgnZ2FtZS94aWFveGlhb2xlL3BsYXlHYW1lJywgcHJlYXMsIHRoaXMucGxheUdhbWVDYWxsLmJpbmQodGhpcykpO1xyXG5cclxuICAgICAgICAvLyBnYW1lZGF0YS5lbmVyZ3kgLT01O1xyXG4gICAgICAgIC8vIGdhbWVkYXRhLmJjX2VuZXJneSgpO1xyXG4gICAgICAgIC8vIC8v6I635Y+W5Yiw57K+5Yqb5Zu+5qCH55qE5L2N572uXHJcbiAgICAgICAgLy8gdmFyIHBvcz10aGlzLmVuZXJneS5wYXJlbnQuY29udmVydFRvV29ybGRTcGFjZUFSKHRoaXMuZW5lcmd5LmdldFBvc2l0aW9uKCkpO1xyXG4gICAgICAgIC8vIC8v6L2s5o2i5Yiw54i254mp5L2T55qE5L2N572uXHJcbiAgICAgICAgLy8gdmFyIHBvczE9dGhpcy5lbmVyZ3lsb2dvLnBhcmVudC5jb252ZXJ0VG9Ob2RlU3BhY2VBUihwb3MpO1xyXG4gICAgICAgIC8vIHRoaXMuZW5lcmd5bG9nby5zZXRQb3NpdGlvbihwb3MxKTtcclxuICAgICAgICAvLyB0aGlzLmVuZXJneWxvZ28ub3BhY2l0eT0yNTU7XHJcbiAgICAgICAgLy8gdGhpcy5lbmVyZ3lsb2dvLnJ1bkFjdGlvbihjYy5tb3ZlVG8oMC41LDI3LC0zNTgpKTtcclxuICAgICAgICAvLyBzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7XHJcbiAgICAgICAgLy8gICAgIGlmKGdhbWVkYXRhLm11c2ljKXtcclxuICAgICAgICAvLyAgICAgICAgIGNjLmF1ZGlvRW5naW5lLnBsYXkodGhpcy5tdXNpY1syXSxmYWxzZSwxKTtcclxuICAgICAgICAvLyAgICAgfVxyXG4gICAgICAgIC8vICAgICAvL2NjLlpMLmx2TWdyLk15cGxheU11c2ljKDIsZmFsc2UpO1xyXG4gICAgICAgIC8vICAgICBjYy5kaXJlY3Rvci5sb2FkU2NlbmUoXCJOZXdNYWluXCIpO1xyXG4gICAgICAgIC8vIH0uYmluZCh0aGlzKSw2MDApO1xyXG4gICAgfSxcclxuXHJcbiAgICBwbGF5R2FtZUNhbGwobXNnKSB7XHJcbiAgICAgICAgY29uc29sZS5sb2coJ3BsYXlnYW1lPT09PicsIG1zZyk7XHJcbiAgICAgICAgaWYgKG1zZy5jb2RlID09IDIwMCkge1xyXG4gICAgICAgICAgICBnYW1lZGF0YS5nYW1lX2NvZGUgPSBtc2cuZGF0YS5nYW1lX2NvZGU7XHJcbiAgICAgICAgICAgIC8vIGdhbWVkYXRhLmVuZXJneSAtPSA1O1xyXG4gICAgICAgICAgICAvLyBnYW1lZGF0YS5iY19lbmVyZ3koKTtcclxuICAgICAgICAgICAgLy/lvZPliY3ph5HluIHmlbDph49cclxuICAgICAgICAgICAgZ2FtZWRhdGEuZ29sZCA9IE51bWJlcihtc2cuZGF0YS5jb2luKTtcclxuICAgICAgICAgICAgLy/lvZPliY3nsr7liptcclxuICAgICAgICAgICAgZ2FtZWRhdGEuZW5lcmd5ID0gTnVtYmVyKG1zZy5kYXRhLmVuZXJneSk7XHJcbiAgICAgICAgICAgIC8v6I635Y+W5Yiw57K+5Yqb5Zu+5qCH55qE5L2N572uXHJcbiAgICAgICAgICAgIHZhciBwb3MgPSB0aGlzLmVuZXJneS5wYXJlbnQuY29udmVydFRvV29ybGRTcGFjZUFSKHRoaXMuZW5lcmd5LmdldFBvc2l0aW9uKCkpO1xyXG4gICAgICAgICAgICAvL+i9rOaNouWIsOeItueJqeS9k+eahOS9jee9rlxyXG4gICAgICAgICAgICB2YXIgcG9zMSA9IHRoaXMuZW5lcmd5bG9nby5wYXJlbnQuY29udmVydFRvTm9kZVNwYWNlQVIocG9zKTtcclxuICAgICAgICAgICAgdGhpcy5lbmVyZ3lsb2dvLnNldFBvc2l0aW9uKHBvczEpO1xyXG4gICAgICAgICAgICB0aGlzLmVuZXJneWxvZ28ub3BhY2l0eSA9IDI1NTtcclxuICAgICAgICAgICAgdGhpcy5lbmVyZ3lsb2dvLnJ1bkFjdGlvbihjYy5tb3ZlVG8oMC41LCAyNywgLTM1OCkpO1xyXG4gICAgICAgICAgICBzZXRUaW1lb3V0KFxyXG4gICAgICAgICAgICAgICAgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChnYW1lZGF0YS5tdXNpYykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjYy5hdWRpb0VuZ2luZS5wbGF5KHRoaXMubXVzaWNbMl0sIGZhbHNlLCAxKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgLy9jYy5aTC5sdk1nci5NeXBsYXlNdXNpYygyLGZhbHNlKTtcclxuICAgICAgICAgICAgICAgICAgICBjYy5kaXJlY3Rvci5sb2FkU2NlbmUoJ05ld01haW4nKTtcclxuICAgICAgICAgICAgICAgIH0uYmluZCh0aGlzKSxcclxuICAgICAgICAgICAgICAgIDYwMFxyXG4gICAgICAgICAgICApO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHV0aWxzLmFkZFRpcHMobXNnLm1lc3NhZ2UpO1xyXG4gICAgICAgIH1cclxuICAgIH0sXHJcbn0pO1xyXG4iXX0=