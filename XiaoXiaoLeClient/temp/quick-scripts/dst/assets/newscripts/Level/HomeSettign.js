
                (function() {
                    var nodeEnv = typeof require !== 'undefined' && typeof process !== 'undefined';
                    var __module = nodeEnv ? module : {exports:{}};
                    var __filename = 'preview-scripts/assets/newscripts/Level/HomeSettign.js';
                    var __require = nodeEnv ? function (request) {
                        return cc.require(request);
                    } : function (request) {
                        return __quick_compile_project__.require(request, __filename);
                    };
                    function __define (exports, require, module) {
                        if (!nodeEnv) {__quick_compile_project__.registerModule(__filename, module);}"use strict";
cc._RF.push(module, '56b53gb+qpHypYixlKcA1Sg', 'HomeSettign');
// newscripts/Level/HomeSettign.js

"use strict";

var _require = require("../UIHelp"),
    UIHelp = _require.UIHelp;

cc.Class({
  "extends": cc.Component,
  properties: {
    //音效按钮
    musicButton: [cc.Sprite],
    //音效按钮纹理
    spr: [cc.SpriteFrame],
    music: {
      type: cc.AudioClip,
      "default": []
    }
  },
  // LIFE-CYCLE CALLBACKS:
  onLoad: function onLoad() {
    this.ShowButton();
  },
  start: function start() {},
  // update (dt) {},
  //显示正确的按钮
  ShowButton: function ShowButton() {
    if (gamedata.bg_music) {
      this.musicButton[0].spriteFrame = this.spr[0];
    } else {
      this.musicButton[0].spriteFrame = this.spr[1];
    }

    if (gamedata.music) {
      this.musicButton[1].spriteFrame = this.spr[2];
    } else {
      this.musicButton[1].spriteFrame = this.spr[3];
    }
  },
  Open: function Open() {
    if (gamedata.music) {
      cc.audioEngine.play(this.music[0], false, 1);
      cc.audioEngine.play(this.music[1], false, 1);
    }

    if (cc.ZL.Level) {
      cc.ZL.Level.OpenMask();
    }

    this.node.y = 2000;
    this.node.runAction(cc.moveTo(0.2, 0, 0).easing(cc.easeBackOut()));
  },
  Close: function Close() {
    cc.director.emit('closeHome');

    if (gamedata.music) {
      cc.audioEngine.play(this.music[0], false, 1);
      cc.audioEngine.play(this.music[1], false, 1);
    }

    if (cc.ZL.Level) {
      cc.ZL.Level.closeMask();
    }

    this.node.runAction(cc.moveTo(0.2, 0, 2000));
  },
  BjmusicDoor: function BjmusicDoor() {
    if (gamedata.music) {
      cc.audioEngine.play(this.music[0], false, 1);
    }

    gamedata.bg_music = !gamedata.bg_music;
    this.ShowButton();

    if (gamedata.bg_music) {
      cc.audioEngine.play(this.music[2], true, 0.5);
    } else {
      cc.audioEngine.stopAll();
    }

    gamedata.bc_music();
  },
  musicDoor: function musicDoor() {
    if (gamedata.music) {
      cc.audioEngine.play(this.music[0], false, 1);
    }

    gamedata.music = !gamedata.music;
    this.ShowButton();
    gamedata.bc_music();
  },
  //重新开启本官
  Again: function Again() {
    if (gamedata.music) {
      cc.audioEngine.play(this.music[0], false, 1);
    }

    if (gamedata.energy > 5) {
      // gamedata.energy -=5;
      // gamedata.bc_energy();
      // cc.director.loadScene("NewMain");
      var preas = {
        rid: gamedata.rid,
        token: gamedata.token,
        level: lvdata.lvl
      };
      UIHelp.network.httpSend('game/xiaoxiaole/playGame', preas, this.playGameCall.bind(this));
    } else {
      utils.addTips('体力不足');
    }
  },
  playGameCall: function playGameCall(msg) {
    console.log('playgame===>', msg);

    if (msg.code == 200) {
      // gamedata.energy -=5;
      // gamedata.bc_energy();
      //当前金币数量
      gamedata.gold = Number(msg.data.coin); //当前精力

      gamedata.energy = Number(msg.data.energy);
      cc.director.loadScene("NewMain");
    } else {
      utils.addTips(msg.message);
    }
  },
  //返回主页面
  GoLevel: function GoLevel() {
    window.utils.ShowLoading(); // utils.ShowLoading();

    if (gamedata.music) {
      cc.audioEngine.play(this.music[0], false, 1);
    }

    cc.director.loadScene("newLevel");
  },
  //返回开始页面
  GoBegin: function GoBegin() {
    if (gamedata.music) {
      cc.audioEngine.play(this.music[0], false, 1);
    }

    cc.director.loadScene("Begin");
  }
});

cc._RF.pop();
                    }
                    if (nodeEnv) {
                        __define(__module.exports, __require, __module);
                    }
                    else {
                        __quick_compile_project__.registerModuleFunc(__filename, function () {
                            __define(__module.exports, __require, __module);
                        });
                    }
                })();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFzc2V0cy9uZXdzY3JpcHRzL0xldmVsL0hvbWVTZXR0aWduLmpzIl0sIm5hbWVzIjpbInJlcXVpcmUiLCJVSUhlbHAiLCJjYyIsIkNsYXNzIiwiQ29tcG9uZW50IiwicHJvcGVydGllcyIsIm11c2ljQnV0dG9uIiwiU3ByaXRlIiwic3ByIiwiU3ByaXRlRnJhbWUiLCJtdXNpYyIsInR5cGUiLCJBdWRpb0NsaXAiLCJvbkxvYWQiLCJTaG93QnV0dG9uIiwic3RhcnQiLCJnYW1lZGF0YSIsImJnX211c2ljIiwic3ByaXRlRnJhbWUiLCJPcGVuIiwiYXVkaW9FbmdpbmUiLCJwbGF5IiwiWkwiLCJMZXZlbCIsIk9wZW5NYXNrIiwibm9kZSIsInkiLCJydW5BY3Rpb24iLCJtb3ZlVG8iLCJlYXNpbmciLCJlYXNlQmFja091dCIsIkNsb3NlIiwiZGlyZWN0b3IiLCJlbWl0IiwiY2xvc2VNYXNrIiwiQmptdXNpY0Rvb3IiLCJzdG9wQWxsIiwiYmNfbXVzaWMiLCJtdXNpY0Rvb3IiLCJBZ2FpbiIsImVuZXJneSIsInByZWFzIiwicmlkIiwidG9rZW4iLCJsZXZlbCIsImx2ZGF0YSIsImx2bCIsIm5ldHdvcmsiLCJodHRwU2VuZCIsInBsYXlHYW1lQ2FsbCIsImJpbmQiLCJ1dGlscyIsImFkZFRpcHMiLCJtc2ciLCJjb25zb2xlIiwibG9nIiwiY29kZSIsImdvbGQiLCJOdW1iZXIiLCJkYXRhIiwiY29pbiIsImxvYWRTY2VuZSIsIm1lc3NhZ2UiLCJHb0xldmVsIiwid2luZG93IiwiU2hvd0xvYWRpbmciLCJHb0JlZ2luIl0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7OztlQUFtQkEsT0FBTyxDQUFDLFdBQUQ7SUFBbEJDLGtCQUFBQTs7QUFDUkMsRUFBRSxDQUFDQyxLQUFILENBQVM7QUFDTCxhQUFTRCxFQUFFLENBQUNFLFNBRFA7QUFHTEMsRUFBQUEsVUFBVSxFQUFFO0FBQ1I7QUFDQUMsSUFBQUEsV0FBVyxFQUFDLENBQUNKLEVBQUUsQ0FBQ0ssTUFBSixD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OztBQUNBLFFBQUdqRCxRQUFRLENBQUNOLEtBQVosRUFBa0I7QUFDZFIsTUFBQUEsRUFBRSxDQUFDa0IsV0FBSCxDQUFlQyxJQUFmLENBQW9CLEtBQUtYLEtBQUwsQ0FBVyxDQUFYLENBQXBCLEVBQWtDLEtBQWxDLEVBQXdDLENBQXhDO0FBQ0g7O0FBQ0RSLElBQUFBLEVBQUUsQ0FBQzhCLFFBQUgsQ0FBWTZCLFNBQVosQ0FBc0IsVUFBdEI7QUFDSCxHQTVISTtBQTZITDtBQUNBSyxFQUFBQSxPQTlISyxxQkE4SEk7QUFDTCxRQUFHbEQsUUFBUSxDQUFDTixLQUFaLEVBQWtCO0FBQ2RSLE1BQUFBLEVBQUUsQ0FBQ2tCLFdBQUgsQ0FBZUMsSUFBZixDQUFvQixLQUFLWCxLQUFMLENBQVcsQ0FBWCxDQUFwQixFQUFrQyxLQUFsQyxFQUF3QyxDQUF4QztBQUNIOztBQUNEUixJQUFBQSxFQUFFLENBQUM4QixRQUFILENBQVk2QixTQUFaLENBQXNCLE9BQXRCO0FBQ0g7QUFuSUksQ0FBVCIsInNvdXJjZVJvb3QiOiIvIiwic291cmNlc0NvbnRlbnQiOlsiY29uc3QgeyBVSUhlbHAgfSA9IHJlcXVpcmUoXCIuLi9VSUhlbHBcIik7XHJcbmNjLkNsYXNzKHtcclxuICAgIGV4dGVuZHM6IGNjLkNvbXBvbmVudCxcclxuXHJcbiAgICBwcm9wZXJ0aWVzOiB7XHJcbiAgICAgICAgLy/pn7PmlYjmjInpkq5cclxuICAgICAgICBtdXNpY0J1dHRvbjpbY2MuU3ByaXRlXSxcclxuICAgICAgICAvL+mfs+aViOaMiemSrue6ueeQhlxyXG4gICAgICAgIHNwcjpbY2MuU3ByaXRlRnJhbWVdLFxyXG4gICAgICAgIG11c2ljOntcclxuICAgICAgICAgICAgdHlwZTpjYy5BdWRpb0NsaXAsXHJcbiAgICAgICAgICAgIGRlZmF1bHQ6W10sXHJcbiAgICAgICAgfVxyXG5cclxuICAgIH0sXHJcblxyXG4gICAgLy8gTElGRS1DWUNMRSBDQUxMQkFDS1M6XHJcblxyXG4gICAgb25Mb2FkICgpIHtcclxuICAgICAgICB0aGlzLlNob3dCdXR0b24oKTtcclxuICAgIH0sXHJcblxyXG4gICAgc3RhcnQgKCkge1xyXG5cclxuICAgIH0sXHJcblxyXG4gICAgLy8gdXBkYXRlIChkdCkge30sXHJcbiAgICAvL+aYvuekuuato+ehrueahOaMiemSrlxyXG4gICAgU2hvd0J1dHRvbigpe1xyXG4gICAgICAgIGlmKGdhbWVkYXRhLmJnX211c2ljKXtcclxuICAgICAgICAgICAgdGhpcy5tdXNpY0J1dHRvblswXS5zcHJpdGVGcmFtZT10aGlzLnNwclswXTtcclxuICAgICAgICB9ZWxzZXtcclxuICAgICAgICAgICAgdGhpcy5tdXNpY0J1dHRvblswXS5zcHJpdGVGcmFtZT10aGlzLnNwclsxXTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYoZ2FtZWRhdGEubXVzaWMpe1xyXG4gICAgICAgICAgICB0aGlzLm11c2ljQnV0dG9uWzFdLnNwcml0ZUZyYW1lPXRoaXMuc3ByWzJdO1xyXG4gICAgICAgIH1lbHNle1xyXG4gICAgICAgICAgICB0aGlzLm11c2ljQnV0dG9uWzFdLnNwcml0ZUZyYW1lPXRoaXMuc3ByWzNdO1xyXG4gICAgICAgIH1cclxuICAgIH0sXHJcbiAgICBPcGVuKCl7XHJcbiAgICAgICAgaWYoZ2FtZWRhdGEubXVzaWMpe1xyXG4gICAgICAgICAgICBjYy5hdWRpb0VuZ2luZS5wbGF5KHRoaXMubXVzaWNbMF0sZmFsc2UsMSk7XHJcbiAgICAgICAgICAgIGNjLmF1ZGlvRW5naW5lLnBsYXkodGhpcy5tdXNpY1sxXSxmYWxzZSwxKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYoY2MuWkwuTGV2ZWwpe1xyXG4gICAgICAgICAgICBjYy5aTC5MZXZlbC5PcGVuTWFzaygpO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLm5vZGUueT0yMDAwO1xyXG4gICAgICAgIHRoaXMubm9kZS5ydW5BY3Rpb24oY2MubW92ZVRvKDAuMiwwLDApLmVhc2luZyhjYy5lYXNlQmFja091dCgpKSk7XHJcbiAgICB9LFxyXG4gICAgQ2xvc2UoKXtcclxuICAgICAgICBjYy5kaXJlY3Rvci5lbWl0KCdjbG9zZUhvbWUnKVxyXG4gICAgICAgIGlmKGdhbWVkYXRhLm11c2ljKXtcclxuICAgICAgICAgICAgY2MuYXVkaW9FbmdpbmUucGxheSh0aGlzLm11c2ljWzBdLGZhbHNlLDEpO1xyXG4gICAgICAgICAgICBjYy5hdWRpb0VuZ2luZS5wbGF5KHRoaXMubXVzaWNbMV0sZmFsc2UsMSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmKGNjLlpMLkxldmVsKXtcclxuICAgICAgICAgICAgY2MuWkwuTGV2ZWwuY2xvc2VNYXNrKCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMubm9kZS5ydW5BY3Rpb24oY2MubW92ZVRvKDAuMiwwLDIwMDApKTtcclxuICAgIH0sXHJcbiAgICBCam11c2ljRG9vcigpe1xyXG4gICAgICAgIGlmKGdhbWVkYXRhLm11c2ljKXtcclxuICAgICAgICAgICAgY2MuYXVkaW9FbmdpbmUucGxheSh0aGlzLm11c2ljWzBdLGZhbHNlLDEpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBnYW1lZGF0YS5iZ19tdXNpYz0hZ2FtZWRhdGEuYmdfbXVzaWM7XHJcbiAgICAgICAgdGhpcy5TaG93QnV0dG9uKCk7XHJcbiAgICAgICAgaWYoZ2FtZWRhdGEuYmdfbXVzaWMpe1xyXG4gICAgICAgICAgICBjYy5hdWRpb0VuZ2luZS5wbGF5KHRoaXMubXVzaWNbMl0sdHJ1ZSwwLjUpO1xyXG4gICAgICAgIH1lbHNle1xyXG4gICAgICAgICAgICBjYy5hdWRpb0VuZ2luZS5zdG9wQWxsKCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGdhbWVkYXRhLmJjX211c2ljKCk7XHJcbiAgICB9LFxyXG4gICAgbXVzaWNEb29yKCl7XHJcbiAgICAgICAgaWYoZ2FtZWRhdGEubXVzaWMpe1xyXG4gICAgICAgICAgICBjYy5hdWRpb0VuZ2luZS5wbGF5KHRoaXMubXVzaWNbMF0sZmFsc2UsMSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGdhbWVkYXRhLm11c2ljPSFnYW1lZGF0YS5tdXNpYztcclxuICAgICAgICB0aGlzLlNob3dCdXR0b24oKTtcclxuICAgICAgICBnYW1lZGF0YS5iY19tdXNpYygpO1xyXG4gICAgfSxcclxuICAgIC8v6YeN5paw5byA5ZCv5pys5a6YXHJcbiAgICBBZ2Fpbigpe1xyXG4gICAgICAgIGlmKGdhbWVkYXRhLm11c2ljKXtcclxuICAgICAgICAgICAgY2MuYXVkaW9FbmdpbmUucGxheSh0aGlzLm11c2ljWzBdLGZhbHNlLDEpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZihnYW1lZGF0YS5lbmVyZ3k+NSl7XHJcbiAgICAgICAgICAgIC8vIGdhbWVkYXRhLmVuZXJneSAtPTU7XHJcbiAgICAgICAgICAgIC8vIGdhbWVkYXRhLmJjX2VuZXJneSgpO1xyXG4gICAgICAgICAgICAvLyBjYy5kaXJlY3Rvci5sb2FkU2NlbmUoXCJOZXdNYWluXCIpO1xyXG4gICAgICAgICAgICBsZXQgcHJlYXMgPSB7XHJcbiAgICAgICAgICAgICAgICByaWQ6IGdhbWVkYXRhLnJpZCxcclxuICAgICAgICAgICAgICAgIHRva2VuOiBnYW1lZGF0YS50b2tlbixcclxuICAgICAgICAgICAgICAgIGxldmVsOiBsdmRhdGEubHZsXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgVUlIZWxwLm5ldHdvcmsuaHR0cFNlbmQoJ2dhbWUveGlhb3hpYW9sZS9wbGF5R2FtZScsIHByZWFzLCB0aGlzLnBsYXlHYW1lQ2FsbC5iaW5kKHRoaXMpKTtcclxuICAgICAgICB9ZWxzZXtcclxuICAgICAgICAgICAgdXRpbHMuYWRkVGlwcygn5L2T5Yqb5LiN6LazJyk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgIH0sXHJcbiAgICBwbGF5R2FtZUNhbGwobXNnKSB7XHJcbiAgICAgICAgY29uc29sZS5sb2coJ3BsYXlnYW1lPT09PicsIG1zZyk7XHJcbiAgICAgICAgaWYgKG1zZy5jb2RlID09IDIwMCkge1xyXG4gICAgICAgICAgICAvLyBnYW1lZGF0YS5lbmVyZ3kgLT01O1xyXG4gICAgICAgICAgICAvLyBnYW1lZGF0YS5iY19lbmVyZ3koKTtcclxuICAgICAgICAgICAgLy/lvZPliY3ph5HluIHmlbDph49cclxuICAgICAgICAgICAgZ2FtZWRhdGEuZ29sZCA9IE51bWJlcihtc2cuZGF0YS5jb2luKTtcclxuICAgICAgICAgICAgLy/lvZPliY3nsr7liptcclxuICAgICAgICAgICAgZ2FtZWRhdGEuZW5lcmd5ID0gTnVtYmVyKG1zZy5kYXRhLmVuZXJneSk7XHJcbiAgICAgICAgICAgIGNjLmRpcmVjdG9yLmxvYWRTY2VuZShcIk5ld01haW5cIik7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgdXRpbHMuYWRkVGlwcyhtc2cubWVzc2FnZSk7XHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuICAgIC8v6L+U5Zue5Li76aG16Z2iXHJcbiAgICBHb0xldmVsKCl7XHJcbiAgICAgICAgd2luZG93LnV0aWxzLlNob3dMb2FkaW5nKCk7XHJcbiAgICAgICAgLy8gXGJ1dGlscy5TaG93TG9hZGluZygpO1xyXG4gICAgICAgIGlmKGdhbWVkYXRhLm11c2ljKXtcclxuICAgICAgICAgICAgY2MuYXVkaW9FbmdpbmUucGxheSh0aGlzLm11c2ljWzBdLGZhbHNlLDEpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBjYy5kaXJlY3Rvci5sb2FkU2NlbmUoXCJuZXdMZXZlbFwiKTtcclxuICAgIH0sXHJcbiAgICAvL+i/lOWbnuW8gOWni+mhtemdolxyXG4gICAgR29CZWdpbigpe1xyXG4gICAgICAgIGlmKGdhbWVkYXRhLm11c2ljKXtcclxuICAgICAgICAgICAgY2MuYXVkaW9FbmdpbmUucGxheSh0aGlzLm11c2ljWzBdLGZhbHNlLDEpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBjYy5kaXJlY3Rvci5sb2FkU2NlbmUoXCJCZWdpblwiKTtcclxuICAgIH1cclxuXHJcbn0pO1xyXG4iXX0=