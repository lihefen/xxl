
                (function() {
                    var nodeEnv = typeof require !== 'undefined' && typeof process !== 'undefined';
                    var __module = nodeEnv ? module : {exports:{}};
                    var __filename = 'preview-scripts/assets/newscripts/Main/Scuess.js';
                    var __require = nodeEnv ? function (request) {
                        return cc.require(request);
                    } : function (request) {
                        return __quick_compile_project__.require(request, __filename);
                    };
                    function __define (exports, require, module) {
                        if (!nodeEnv) {__quick_compile_project__.registerModule(__filename, module);}"use strict";
cc._RF.push(module, '1b19e5BnRtNAbD8mmt8Vt/l', 'Scuess');
// newscripts/Main/Scuess.js

"use strict";

cc.Class({
  "extends": cc.Component,
  properties: {
    //旋转的背景
    circlebg: cc.Node,
    //分数
    scoreLabel: cc.Label,
    goldLabel: cc.Label,
    //三组星星
    Stars: [cc.Node]
  },
  onLoad: function onLoad() {},
  start: function start() {},
  update: function update(dt) {
    this.circlebg.angle += 60 * dt;
  },
  InitView: function InitView() {
    cc.ZL.musicMgr.MyplayMusic(26, false);
    this.node.runAction(cc.scaleTo(0.2, 1, 1));
    this.scoreLabel.string = cc.ZL.UIMgr._score;
    this.goldLabel.string = Math.floor(cc.ZL.UIMgr._score / 1000);
    this.showstars();
  },
  showstars: function showstars() {
    var num = cc.ZL.UIMgr.GetStarNum(); // let num=3;

    if (num == 1) {
      cc.ZL.musicMgr.MyplayMusic(17, false);
      this.BigSmall(this.Stars[0]);
    } else if (num == 2) {
      cc.ZL.musicMgr.MyplayMusic(17, false);
      this.BigSmall(this.Stars[0]);
      setTimeout(function () {
        cc.ZL.musicMgr.MyplayMusic(18, false);
        this.BigSmall(this.Stars[1]);
      }.bind(this), 300);
    } else if (num == 3) {
      cc.ZL.musicMgr.MyplayMusic(17, false);
      this.BigSmall(this.Stars[0]);
      setTimeout(function () {
        cc.ZL.musicMgr.MyplayMusic(18, false);
        this.BigSmall(this.Stars[1]);
        setTimeout(function () {
          cc.ZL.musicMgr.MyplayMusic(19, false);
          this.BigSmall(this.Stars[2]);
        }.bind(this), 300);
      }.bind(this), 300);
    } //gamedata.Lv_star[comeInfo.now_lv]=num;


    if (comeInfo.now_lv >= gamedata.Lv_star) {
      gamedata.Lv_star = comeInfo.now_lv;
      gamedata.bc_Star();
    }
  },
  //星星变大缩小
  BigSmall: function BigSmall(node) {
    var fn1 = cc.scaleTo(0.2, 1.5, 1.5);
    var fn2 = cc.scaleTo(0.1, 1, 1);
    var sqn = cc.sequence(fn1, fn2);
    node.runAction(sqn);
  },
  //双倍领取
  DoubleGold: function DoubleGold() {
    cc.ZL.musicMgr.MyplayMusic(0, false);
    gamedata.gold += Math.floor(cc.ZL.UIMgr._score / 1000) * 2;
    gamedata.bc_gold();
    cc.director.loadScene("newLevel");
  },
  //普通领取
  NormalGold: function NormalGold() {
    this.node.getChildByName('normalGold').getComponent(cc.Button).interactable = false;
    this.node.getChildByName('next').getComponent(cc.Button).interactable = false;
    cc.ZL.musicMgr.MyplayMusic(0, false);
    gamedata.gold += Math.floor(cc.ZL.UIMgr._score / 1000);
    gamedata.bc_gold();
    cc.director.loadScene("newLevel");
  },
  NextHall: function NextHall(event) {
    var _this = this;

    if (Number(comeInfo.now_lv) == 500) {
      utils.addTips('已经是最后一关啦！');
      return;
    }

    this.node.getChildByName('normalGold').getComponent(cc.Button).interactable = false;
    this.node.getChildByName('next').getComponent(cc.Button).interactable = false;
    cc.ZL.musicMgr.MyplayMusic(0, false);
    gamedata.gold += Math.floor(cc.ZL.UIMgr._score / 1000);
    gamedata.bc_gold();
    utils.ShowLoading();
    cc.director.loadScene("newLevel", function () {
      cc.ZL.Level.OpenMask();
      console.log('OpenMask');
      cc.loader.loadRes('levels/' + (Number(comeInfo.now_lv) + 1), function (err, res) {
        if (err) {
          _this.node.getChildByName('normalGold').getComponent(cc.Button).interactable = true;
          _this.node.getChildByName('next').getComponent(cc.Button).interactable = true;
          console.log("load res error=" + err);
        } else {
          // console.log(lvdata['Lv1'])
          // setTimeout(function () {
          lvdata = JSON.parse(res.text); // console.log('=====>',lvdatacc)

          cc.ZL.Target.InitView(Number(comeInfo.now_lv) + 1); // }, 1000);
        }
      });
    });
  }
});

cc._RF.pop();
                    }
                    if (nodeEnv) {
                        __define(__module.exports, __require, __module);
                    }
                    else {
                        __quick_compile_project__.registerModuleFunc(__filename, function () {
                            __define(__module.exports, __require, __module);
                        });
                    }
                })();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFzc2V0cy9uZXdzY3JpcHRzL01haW4vU2N1ZXNzLmpzIl0sIm5hbWVzIjpbImNjIiwiQ2xhc3MiLCJDb21wb25lbnQiLCJwcm9wZXJ0aWVzIiwiY2lyY2xlYmciLCJOb2RlIiwic2NvcmVMYWJlbCIsIkxhYmVsIiwiZ29sZExhYmVsIiwiU3RhcnMiLCJvbkxvYWQiLCJzdGFydCIsInVwZGF0ZSIsImR0IiwiYW5nbGUiLCJJbml0VmlldyIsIlpMIiwibXVzaWNNZ3IiLCJNeXBsYXlNdXNpYyIsIm5vZGUiLCJydW5BY3Rpb24iLCJzY2FsZVRvIiwic3RyaW5nIiwiVUlNZ3IiLCJfc2NvcmUiLCJNYXRoIiwiZmxvb3IiLCJzaG93c3RhcnMiLCJudW0iLCJHZXRTdGFyTnVtIiwiQmlnU21hbGwiLCJzZXRUaW1lb3V0IiwiYmluZCIsImNvbWVJbmZvIiwibm93X2x2IiwiZ2FtZWRhdGEiLCJMdl9zdGFyIiwiYmNfU3RhciIsImZuMSIsImZuMiIsInNxbiIsInNlcXVlbmNlIiwiRG91YmxlR29sZCIsImdvbGQiLCJiY19nb2xkIiwiZGlyZWN0b3IiLCJsb2FkU2NlbmUiLCJOb3JtYWxHb2xkIiwiZ2V0Q2hpbGRCeU5hbWUiLCJnZXRDb21wb25lbnQiLCJCdXR0b24iLCJpbnRlcmFjdGFibGUiLCJOZXh0SGFsbCIsImV2ZW50IiwiTnVtYmVyIiwidXRpbHMiLCJhZGRUaXBzIiwiU2hvd0xvYWRpbmciLCJMZXZlbCIsIk9wZW5NYXNrIiwiY29uc29sZSIsImxvZyIsImxvYWRlciIsImxvYWRSZXMiLCJlcnIiLCJyZXMiLCJsdmRhdGEiLCJKU09OIiwicGFyc2UiLCJ0ZXh0IiwiVGFyZ2V0Il0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7OztBQUVBQSxFQUFFLENBQUNDLEtBQUgsQ0FBUztBQUNMLGFBQVNELEVBQUUsQ0FBQ0UsU0FEUDtBQUdMQyxFQUFBQSxVQUFVLEVBQUU7QUFDUjtBQUNBQyxJQUFBQSxRQUFRLEVBQUVKLEVBQUUsQ0FBQ0ssSUFGTDtBQUdS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QUNBO0FBQ0lFLFVBQUFBLE1BQU0sR0FBR0MsSUFBSSxDQUFDQyxLQUFMLENBQVdILEdBQUcsQ0FBQ0ksSUFBZixDQUFULENBSEQsQ0FJQzs7QUFDQXJFLFVBQUFBLEVBQUUsQ0FBQ2dCLEVBQUgsQ0FBTXNELE1BQU4sQ0FBYXZELFFBQWIsQ0FBdUJ1QyxNQUFNLENBQUNyQixRQUFRLENBQUNDLE1BQVYsQ0FBTixHQUEwQixDQUFqRCxFQUxELENBTUg7QUFDSDtBQUNKLE9BYkQ7QUFjSCxLQWpCRDtBQWtCSDtBQXBISSxDQUFUIiwic291cmNlUm9vdCI6Ii8iLCJzb3VyY2VzQ29udGVudCI6WyJcclxuXHJcbmNjLkNsYXNzKHtcclxuICAgIGV4dGVuZHM6IGNjLkNvbXBvbmVudCxcclxuXHJcbiAgICBwcm9wZXJ0aWVzOiB7XHJcbiAgICAgICAgLy/ml4vovaznmoTog4zmma9cclxuICAgICAgICBjaXJjbGViZzogY2MuTm9kZSxcclxuICAgICAgICAvL+WIhuaVsFxyXG4gICAgICAgIHNjb3JlTGFiZWw6IGNjLkxhYmVsLFxyXG4gICAgICAgIGdvbGRMYWJlbDogY2MuTGFiZWwsXHJcbiAgICAgICAgLy/kuInnu4TmmJ/mmJ9cclxuICAgICAgICBTdGFyczogW2NjLk5vZGVdLFxyXG4gICAgfSxcclxuXHJcbiAgICBvbkxvYWQoKSB7XHJcbiAgICB9LFxyXG5cclxuICAgIHN0YXJ0KCkge1xyXG5cclxuICAgIH0sXHJcblxyXG4gICAgdXBkYXRlKGR0KSB7XHJcbiAgICAgICAgdGhpcy5jaXJjbGViZy5hbmdsZSArPSA2MCAqIGR0O1xyXG4gICAgfSxcclxuICAgIEluaXRWaWV3KCkge1xyXG4gICAgICAgIGNjLlpMLm11c2ljTWdyLk15cGxheU11c2ljKDI2LCBmYWxzZSk7XHJcbiAgICAgICAgdGhpcy5ub2RlLnJ1bkFjdGlvbihjYy5zY2FsZVRvKDAuMiwgMSwgMSkpO1xyXG4gICAgICAgIHRoaXMuc2NvcmVMYWJlbC5zdHJpbmcgPSBjYy5aTC5VSU1nci5fc2NvcmU7XHJcbiAgICAgICAgdGhpcy5nb2xkTGFiZWwuc3RyaW5nID0gTWF0aC5mbG9vcihjYy5aTC5VSU1nci5fc2NvcmUgLyAxMDAwKTtcclxuICAgICAgICB0aGlzLnNob3dzdGFycygpO1xyXG4gICAgfSxcclxuICAgIHNob3dzdGFycygpIHtcclxuICAgICAgICBsZXQgbnVtID0gY2MuWkwuVUlNZ3IuR2V0U3Rhck51bSgpO1xyXG4gICAgICAgIC8vIGxldCBudW09MztcclxuICAgICAgICBpZiAobnVtID09IDEpIHtcclxuICAgICAgICAgICAgY2MuWkwubXVzaWNNZ3IuTXlwbGF5TXVzaWMoMTcsIGZhbHNlKTtcclxuICAgICAgICAgICAgdGhpcy5CaWdTbWFsbCh0aGlzLlN0YXJzWzBdKTtcclxuICAgICAgICB9IGVsc2UgaWYgKG51bSA9PSAyKSB7XHJcbiAgICAgICAgICAgIGNjLlpMLm11c2ljTWdyLk15cGxheU11c2ljKDE3LCBmYWxzZSk7XHJcbiAgICAgICAgICAgIHRoaXMuQmlnU21hbGwodGhpcy5TdGFyc1swXSk7XHJcbiAgICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgY2MuWkwubXVzaWNNZ3IuTXlwbGF5TXVzaWMoMTgsIGZhbHNlKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuQmlnU21hbGwodGhpcy5TdGFyc1sxXSk7XHJcbiAgICAgICAgICAgIH0uYmluZCh0aGlzKSwgMzAwKTtcclxuXHJcbiAgICAgICAgfSBlbHNlIGlmIChudW0gPT0gMykge1xyXG4gICAgICAgICAgICBjYy5aTC5tdXNpY01nci5NeXBsYXlNdXNpYygxNywgZmFsc2UpO1xyXG4gICAgICAgICAgICB0aGlzLkJpZ1NtYWxsKHRoaXMuU3RhcnNbMF0pO1xyXG4gICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIGNjLlpMLm11c2ljTWdyLk15cGxheU11c2ljKDE4LCBmYWxzZSk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLkJpZ1NtYWxsKHRoaXMuU3RhcnNbMV0pO1xyXG4gICAgICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY2MuWkwubXVzaWNNZ3IuTXlwbGF5TXVzaWMoMTksIGZhbHNlKTtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLkJpZ1NtYWxsKHRoaXMuU3RhcnNbMl0pO1xyXG4gICAgICAgICAgICAgICAgfS5iaW5kKHRoaXMpLCAzMDApO1xyXG4gICAgICAgICAgICB9LmJpbmQodGhpcyksIDMwMCk7XHJcblxyXG4gICAgICAgIH1cclxuICAgICAgICAvL2dhbWVkYXRhLkx2X3N0YXJbY29tZUluZm8ubm93X2x2XT1udW07XHJcbiAgICAgICAgaWYgKGNvbWVJbmZvLm5vd19sdiA+PSBnYW1lZGF0YS5Mdl9zdGFyKSB7XHJcbiAgICAgICAgICAgIGdhbWVkYXRhLkx2X3N0YXIgPSBjb21lSW5mby5ub3dfbHY7XHJcbiAgICAgICAgICAgIGdhbWVkYXRhLmJjX1N0YXIoKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgfSxcclxuICAgIC8v5pif5pif5Y+Y5aSn57yp5bCPXHJcbiAgICBCaWdTbWFsbChub2RlKSB7XHJcbiAgICAgICAgbGV0IGZuMSA9IGNjLnNjYWxlVG8oMC4yLCAxLjUsIDEuNSk7XHJcbiAgICAgICAgbGV0IGZuMiA9IGNjLnNjYWxlVG8oMC4xLCAxLCAxKTtcclxuICAgICAgICBsZXQgc3FuID0gY2Muc2VxdWVuY2UoZm4xLCBmbjIpO1xyXG4gICAgICAgIG5vZGUucnVuQWN0aW9uKHNxbik7XHJcbiAgICB9LFxyXG4gICAgLy/lj4zlgI3pooblj5ZcclxuICAgIERvdWJsZUdvbGQoKSB7XHJcbiAgICAgICAgY2MuWkwubXVzaWNNZ3IuTXlwbGF5TXVzaWMoMCwgZmFsc2UpO1xyXG4gICAgICAgIGdhbWVkYXRhLmdvbGQgKz0gTWF0aC5mbG9vcihjYy5aTC5VSU1nci5fc2NvcmUgLyAxMDAwKSAqIDI7XHJcbiAgICAgICAgZ2FtZWRhdGEuYmNfZ29sZCgpO1xyXG4gICAgICAgIGNjLmRpcmVjdG9yLmxvYWRTY2VuZShcIm5ld0xldmVsXCIpO1xyXG4gICAgfSxcclxuICAgIC8v5pmu6YCa6aKG5Y+WXHJcbiAgICBOb3JtYWxHb2xkKCkge1xyXG4gICAgICAgIHRoaXMubm9kZS5nZXRDaGlsZEJ5TmFtZSgnbm9ybWFsR29sZCcpLmdldENvbXBvbmVudChjYy5CdXR0b24pLmludGVyYWN0YWJsZSA9IGZhbHNlO1xyXG4gICAgICAgIHRoaXMubm9kZS5nZXRDaGlsZEJ5TmFtZSgnbmV4dCcpLmdldENvbXBvbmVudChjYy5CdXR0b24pLmludGVyYWN0YWJsZSA9IGZhbHNlO1xyXG4gICAgICAgIGNjLlpMLm11c2ljTWdyLk15cGxheU11c2ljKDAsIGZhbHNlKTtcclxuICAgICAgICBnYW1lZGF0YS5nb2xkICs9IE1hdGguZmxvb3IoY2MuWkwuVUlNZ3IuX3Njb3JlIC8gMTAwMCk7XHJcbiAgICAgICAgZ2FtZWRhdGEuYmNfZ29sZCgpO1xyXG4gICAgICAgIGNjLmRpcmVjdG9yLmxvYWRTY2VuZShcIm5ld0xldmVsXCIpO1xyXG4gICAgfSxcclxuICAgIE5leHRIYWxsKGV2ZW50KSB7XHJcbiAgICAgICAgaWYoTnVtYmVyKGNvbWVJbmZvLm5vd19sdikgPT0gNTAwKSB7XHJcbiAgICAgICAgICAgIHV0aWxzLmFkZFRpcHMoJ+W3sue7j+aYr+acgOWQjuS4gOWFs+WVpu+8gScpO1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMubm9kZS5nZXRDaGlsZEJ5TmFtZSgnbm9ybWFsR29sZCcpLmdldENvbXBvbmVudChjYy5CdXR0b24pLmludGVyYWN0YWJsZSA9IGZhbHNlO1xyXG4gICAgICAgIHRoaXMubm9kZS5nZXRDaGlsZEJ5TmFtZSgnbmV4dCcpLmdldENvbXBvbmVudChjYy5CdXR0b24pLmludGVyYWN0YWJsZSA9IGZhbHNlO1xyXG4gICAgICAgIGNjLlpMLm11c2ljTWdyLk15cGxheU11c2ljKDAsIGZhbHNlKTtcclxuICAgICAgICBnYW1lZGF0YS5nb2xkICs9IE1hdGguZmxvb3IoY2MuWkwuVUlNZ3IuX3Njb3JlIC8gMTAwMCk7XHJcbiAgICAgICAgZ2FtZWRhdGEuYmNfZ29sZCgpO1xyXG4gICAgICAgIHV0aWxzLlNob3dMb2FkaW5nKCk7XHJcbiAgICAgICAgY2MuZGlyZWN0b3IubG9hZFNjZW5lKFwibmV3TGV2ZWxcIiwgKCkgPT4ge1xyXG4gICAgICAgICAgICBjYy5aTC5MZXZlbC5PcGVuTWFzaygpO1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZygnT3Blbk1hc2snKVxyXG4gICAgICAgICAgICBjYy5sb2FkZXIubG9hZFJlcygnbGV2ZWxzLycgKyAoTnVtYmVyKGNvbWVJbmZvLm5vd19sdikgKyAxKSwgKGVyciwgcmVzKSA9PiB7XHJcbiAgICAgICAgICAgICAgICBpZiAoZXJyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5ub2RlLmdldENoaWxkQnlOYW1lKCdub3JtYWxHb2xkJykuZ2V0Q29tcG9uZW50KGNjLkJ1dHRvbikuaW50ZXJhY3RhYmxlID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLm5vZGUuZ2V0Q2hpbGRCeU5hbWUoJ25leHQnKS5nZXRDb21wb25lbnQoY2MuQnV0dG9uKS5pbnRlcmFjdGFibGUgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwibG9hZCByZXMgZXJyb3I9XCIgKyBlcnIpO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZyhsdmRhdGFbJ0x2MSddKVxyXG4gICAgICAgICAgICAgICAgICAgIC8vIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBsdmRhdGEgPSBKU09OLnBhcnNlKHJlcy50ZXh0KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gY29uc29sZS5sb2coJz09PT09PicsbHZkYXRhY2MpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNjLlpMLlRhcmdldC5Jbml0VmlldygoTnVtYmVyKGNvbWVJbmZvLm5vd19sdikgKyAxKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gfSwgMTAwMCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcbn0pO1xyXG4iXX0=