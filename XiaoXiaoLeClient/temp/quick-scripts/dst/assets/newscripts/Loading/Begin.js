
                (function() {
                    var nodeEnv = typeof require !== 'undefined' && typeof process !== 'undefined';
                    var __module = nodeEnv ? module : {exports:{}};
                    var __filename = 'preview-scripts/assets/newscripts/Loading/Begin.js';
                    var __require = nodeEnv ? function (request) {
                        return cc.require(request);
                    } : function (request) {
                        return __quick_compile_project__.require(request, __filename);
                    };
                    function __define (exports, require, module) {
                        if (!nodeEnv) {__quick_compile_project__.registerModule(__filename, module);}"use strict";
cc._RF.push(module, 'cfdd6kzs+xMzZl9ecIgNfLR', 'Begin');
// newscripts/Loading/Begin.js

"use strict";

var _require = require('../UIHelp'),
    UIHelp = _require.UIHelp;

cc.Class({
  "extends": cc.Component,
  properties: {
    music: {
      type: cc.AudioClip,
      "default": null
    },
    //文字提示框
    tipLabel: [cc.Label],
    //进度条
    pro_loading: cc.ProgressBar,
    //骨骼动画
    Logo: cc.Node
  },
  onLoad: function onLoad() {
    UIHelp.init();

    if (cc.ZL = null) {
      cc.ZL = {};
    } //wx.clearStorage();
    // gamedata.GetData();


    cc.audioEngine.play(this.music, true, 0.3);
    this.LogoAnim(); // this.LoadingChild();
  },
  start: function start() {},
  //播放出场动画
  LogoAnim: function LogoAnim() {
    var anim = this.Logo.getComponent(sp.Skeleton);
    anim.clearTracks();
    anim.addAnimation(0, 'start', false, 0);
    anim.addAnimation(0, 'play', false, 0);
    anim.addAnimation(0, 'end', false, 0);
    anim.setEndListener(function (res) {
      if (res.animation.name == 'play') {
        this.LoadingChild();
      }
    }.bind(this));
  },
  //加载子包
  LoadingChild: function LoadingChild() {
    var self = this;

    try {
      var data = {
        roomID: '1',
        token: '2'
      };

      if (data.roomID) {
        gamedata.rid = data.roomID;
      }

      if (data.token) {
        gamedata.token = data.token;
      }

      cc.director.loadScene('newLevel');

      if (!gamedata.rid || !gamedata.token) {
        utils.addTips('参数错误');
        return;
      } // winOcx.getUserData((data) => {
      //     if (data.roomID) {
      //         gamedata.rid = data.roomID;
      //     }
      //     if (data.token) {
      //         gamedata.token = data.token;
      //     }
      //     if (!gamedata.rid || !gamedata.token) {
      //         utils.addTips('参数错误');
      //         return;
      //     }
      // });

    } catch (error) {
      gamedata.rid = utils.getQueryString('rid');
      gamedata.token = utils.getQueryString('token');

      if (!gamedata.rid || !gamedata.token) {
        utils.addTips('参数错误');
        return;
      }

      this.login();
    }
  },
  login: function login() {
    var preas = {
      rid: gamedata.rid,
      token: gamedata.token
    };
    UIHelp.network.httpSend('game/xiaoxiaole/getGameInfo', preas, this.loginCall.bind(this));
  },
  loginCall: function loginCall(msg) {
    console.log('login==>', msg);

    if (msg.code == 200) {
      gamedata.Lv_star = Number(msg.data.current_level); // gamedata.Lv_star = 74;

      gamedata.level_stars = msg.data.level_stars; //当前金币数量

      gamedata.gold = Number(msg.data.coin); //当前精力

      gamedata.energy = Number(msg.data.energy);
      var preas = {
        rid: gamedata.rid,
        token: gamedata.token
      };
      UIHelp.network.httpConnect_post_async('game/xiaoxiaole/getMyPropList', preas, this.getMyPropListCallBack.bind(this));
    } else {
      utils.addTips(msg.message);
    }
  },
  getMyPropListCallBack: function getMyPropListCallBack(msg) {
    console.log('getmyPrropList====>', msg);

    if (msg.code == 200) {
      if (msg.data.length > 0) {
        for (var a = 0; a < msg.data.length; a++) {
          if (msg.data[a].gid == 10001) {
            gamedata.prop[1] = Number(msg.data[a].num);
          } else if (msg.data[a].gid == 10002) {
            gamedata.prop[3] = Number(msg.data[a].num);
          } else if (msg.data[a].gid == 10003) {
            gamedata.prop[4] = Number(msg.data[a].num);
          }
        }
      }

      this.preLoading();
    } else {
      utils.addTips(msg.message);
    }
  },
  //预先加载资源
  preLoading: function preLoading() {
    var _this = this;

    var self = this; // self.tipLabel[1].string = "正在加载资源......";

    self.is_Loading = true;

    var onProcess = function onProcess(completecount, totalcount, item) {
      if (self.is_Loading) {
        var progress = completecount / totalcount * 0.5;
        self.tipLabel[0].string = Math.floor(progress * 100) + '%'; //console.log(progress);

        self.pro_loading.progress = progress;
      }
    };

    var onProcess1 = function onProcess1(completecount, totalcount, item) {
      if (self.is_Loading) {
        var progress = completecount / totalcount * 0.5 + 0.5;
        self.tipLabel[0].string = Math.floor(progress * 100) + '%'; //console.log(progress);

        self.pro_loading.progress = progress;
      }
    };

    cc.director.preloadScene('newLevel', onProcess, function () {
      cc.director.preloadScene('NewMain', onProcess1, function () {
        self.is_Loading = false;
        setTimeout(function () {
          cc.director.loadScene('newLevel');
        }.bind(_this), 1000);
      });
    }); // cc.loader.loadResDir("texture", onProcess, function (err, assets) {
    //     if (err) {
    //         self.tipLabel[1].string = "加载资源错误";
    //     } else {
    //         self.is_Loading = false;
    //         setTimeout(function () {
    //             cc.director.loadScene("newLevel");
    //         }.bind(this), 1000);
    //         // self.tipLabel[1].string = "加载关卡资源.......";
    //         // cc.loader.loadResDir('levels', cc.TextAsset, (err, res) => {
    //         //     if (err) {
    //         //         console.log("load res error=" + err);
    //         //     } else {
    //         //         // gamedata.Lv_star = res.length - 1;
    //         //         // console.log('sdafsdfa', gamedata.Lv_star)
    //         //         self.tipLabel[1].string = "加载资源成功，正在进入游戏";
    //         //         setTimeout(function () {
    //         //             cc.director.loadScene("newLevel");
    //         //         }.bind(this), 1000);
    //         //     }
    //         // })
    //     }
    // })
  }
});

cc._RF.pop();
                    }
                    if (nodeEnv) {
                        __define(__module.exports, __require, __module);
                    }
                    else {
                        __quick_compile_project__.registerModuleFunc(__filename, function () {
                            __define(__module.exports, __require, __module);
                        });
                    }
                })();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFzc2V0cy9uZXdzY3JpcHRzL0xvYWRpbmcvQmVnaW4uanMiXSwibmFtZXMiOlsicmVxdWlyZSIsIlVJSGVscCIsImNjIiwiQ2xhc3MiLCJDb21wb25lbnQiLCJwcm9wZXJ0aWVzIiwibXVzaWMiLCJ0eXBlIiwiQXVkaW9DbGlwIiwidGlwTGFiZWwiLCJMYWJlbCIsInByb19sb2FkaW5nIiwiUHJvZ3Jlc3NCYXIiLCJMb2dvIiwiTm9kZSIsIm9uTG9hZCIsImluaXQiLCJaTCIsImF1ZGlvRW5naW5lIiwicGxheSIsIkxvZ29BbmltIiwic3RhcnQiLCJhbmltIiwiZ2V0Q29tcG9uZW50Iiwic3AiLCJTa2VsZXRvbiIsImNsZWFyVHJhY2tzIiwiYWRkQW5pbWF0aW9uIiwic2V0RW5kTGlzdGVuZXIiLCJyZXMiLCJhbmltYXRpb24iLCJuYW1lIiwiTG9hZGluZ0NoaWxkIiwiYmluZCIsInNlbGYiLCJkYXRhIiwicm9vbUlEIiwidG9rZW4iLCJnYW1lZGF0YSIsInJpZCIsImRpcmVjdG9yIiwibG9hZFNjZW5lIiwidXRpbHMiLCJhZGRUaXBzIiwiZXJyb3IiLCJnZXRRdWVyeVN0cmluZyIsImxvZ2luIiwicHJlYXMiLCJuZXR3b3JrIiwiaHR0cFNlbmQiLCJsb2dpbkNhbGwiLCJtc2ciLCJjb25zb2xlIiwibG9nIiwiY29kZSIsIkx2X3N0YXIiLCJOdW1iZXIiLCJjdXJyZW50X2xldmVsIiwibGV2ZWxfc3RhcnMiLCJnb2xkIiwiY29pbiIsImVuZXJneSIsImh0dHBDb25uZWN0X3Bvc3RfYXN5bmMiLCJnZXRNeVByb3BMaXN0Q2FsbEJhY2siLCJtZXNzYWdlIiwibGVuZ3RoIiwiYSIsImdpZCIsInByb3AiLCJudW0iLCJwcmVMb2FkaW5nIiwiaXNfTG9hZGluZyIsIm9uUHJvY2VzcyIsImNvbXBsZXRlY291bnQiLCJ0b3RhbGNvdW50IiwiaXRlbSIsInByb2dyZXNzIiwic3RyaW5nIiwiTWF0aCIsImZsb29yIiwib25Qcm9jZXNzMSIsInByZWxvYWRTY2VuZSIs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QUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDSDtBQW5NSSxDQUFUIiwic291cmNlUm9vdCI6Ii8iLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCB7IFVJSGVscCB9ID0gcmVxdWlyZSgnLi4vVUlIZWxwJyk7XHJcblxyXG5jYy5DbGFzcyh7XHJcbiAgICBleHRlbmRzOiBjYy5Db21wb25lbnQsXHJcblxyXG4gICAgcHJvcGVydGllczoge1xyXG4gICAgICAgIG11c2ljOiB7XHJcbiAgICAgICAgICAgIHR5cGU6IGNjLkF1ZGlvQ2xpcCxcclxuICAgICAgICAgICAgZGVmYXVsdDogbnVsbCxcclxuICAgICAgICB9LFxyXG4gICAgICAgIC8v5paH5a2X5o+Q56S65qGGXHJcbiAgICAgICAgdGlwTGFiZWw6IFtjYy5MYWJlbF0sXHJcbiAgICAgICAgLy/ov5vluqbmnaFcclxuICAgICAgICBwcm9fbG9hZGluZzogY2MuUHJvZ3Jlc3NCYXIsXHJcblxyXG4gICAgICAgIC8v6aqo6aq85Yqo55S7XHJcbiAgICAgICAgTG9nbzogY2MuTm9kZSxcclxuICAgIH0sXHJcblxyXG4gICAgb25Mb2FkKCkge1xyXG4gICAgICAgIFVJSGVscC5pbml0KCk7XHJcbiAgICAgICAgaWYgKChjYy5aTCA9IG51bGwpKSB7XHJcbiAgICAgICAgICAgIGNjLlpMID0ge307XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vd3guY2xlYXJTdG9yYWdlKCk7XHJcbiAgICAgICAgLy8gZ2FtZWRhdGEuR2V0RGF0YSgpO1xyXG4gICAgICAgIGNjLmF1ZGlvRW5naW5lLnBsYXkodGhpcy5tdXNpYywgdHJ1ZSwgMC4zKTtcclxuICAgICAgICB0aGlzLkxvZ29BbmltKCk7XHJcblxyXG4gICAgICAgIC8vIHRoaXMuTG9hZGluZ0NoaWxkKCk7XHJcbiAgICB9LFxyXG5cclxuICAgIHN0YXJ0KCkge30sXHJcbiAgICAvL+aSreaUvuWHuuWcuuWKqOeUu1xyXG4gICAgTG9nb0FuaW0oKSB7XHJcbiAgICAgICAgbGV0IGFuaW0gPSB0aGlzLkxvZ28uZ2V0Q29tcG9uZW50KHNwLlNrZWxldG9uKTtcclxuICAgICAgICBhbmltLmNsZWFyVHJhY2tzKCk7XHJcbiAgICAgICAgYW5pbS5hZGRBbmltYXRpb24oMCwgJ3N0YXJ0JywgZmFsc2UsIDApO1xyXG4gICAgICAgIGFuaW0uYWRkQW5pbWF0aW9uKDAsICdwbGF5JywgZmFsc2UsIDApO1xyXG4gICAgICAgIGFuaW0uYWRkQW5pbWF0aW9uKDAsICdlbmQnLCBmYWxzZSwgMCk7XHJcbiAgICAgICAgYW5pbS5zZXRFbmRMaXN0ZW5lcihcclxuICAgICAgICAgICAgZnVuY3Rpb24gKHJlcykge1xyXG4gICAgICAgICAgICAgICAgaWYgKHJlcy5hbmltYXRpb24ubmFtZSA9PSAncGxheScpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLkxvYWRpbmdDaGlsZCgpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9LmJpbmQodGhpcylcclxuICAgICAgICApO1xyXG4gICAgfSxcclxuICAgIC8v5Yqg6L295a2Q5YyFXHJcbiAgICBMb2FkaW5nQ2hpbGQoKSB7XHJcbiAgICAgICAgbGV0IHNlbGYgPSB0aGlzO1xyXG4gICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGRhdGEgPSB7XHJcbiAgICAgICAgICAgICAgICByb29tSUQ6ICcxJyxcclxuICAgICAgICAgICAgICAgIHRva2VuOiAnMicsXHJcbiAgICAgICAgICAgIH07XHJcblxyXG4gICAgICAgICAgICBpZiAoZGF0YS5yb29tSUQpIHtcclxuICAgICAgICAgICAgICAgIGdhbWVkYXRhLnJpZCA9IGRhdGEucm9vbUlEO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmIChkYXRhLnRva2VuKSB7XHJcbiAgICAgICAgICAgICAgICBnYW1lZGF0YS50b2tlbiA9IGRhdGEudG9rZW47XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgY2MuZGlyZWN0b3IubG9hZFNjZW5lKCduZXdMZXZlbCcpO1xyXG4gICAgICAgICAgICBpZiAoIWdhbWVkYXRhLnJpZCB8fCAhZ2FtZWRhdGEudG9rZW4pIHtcclxuICAgICAgICAgICAgICAgIHV0aWxzLmFkZFRpcHMoJ+WPguaVsOmUmeivrycpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAvLyB3aW5PY3guZ2V0VXNlckRhdGEoKGRhdGEpID0+IHtcclxuICAgICAgICAgICAgLy8gICAgIGlmIChkYXRhLnJvb21JRCkge1xyXG4gICAgICAgICAgICAvLyAgICAgICAgIGdhbWVkYXRhLnJpZCA9IGRhdGEucm9vbUlEO1xyXG4gICAgICAgICAgICAvLyAgICAgfVxyXG4gICAgICAgICAgICAvLyAgICAgaWYgKGRhdGEudG9rZW4pIHtcclxuICAgICAgICAgICAgLy8gICAgICAgICBnYW1lZGF0YS50b2tlbiA9IGRhdGEudG9rZW47XHJcbiAgICAgICAgICAgIC8vICAgICB9XHJcbiAgICAgICAgICAgIC8vICAgICBpZiAoIWdhbWVkYXRhLnJpZCB8fCAhZ2FtZWRhdGEudG9rZW4pIHtcclxuICAgICAgICAgICAgLy8gICAgICAgICB1dGlscy5hZGRUaXBzKCflj4LmlbDplJnor68nKTtcclxuICAgICAgICAgICAgLy8gICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgIC8vICAgICB9XHJcbiAgICAgICAgICAgIC8vIH0pO1xyXG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgICAgICAgIGdhbWVkYXRhLnJpZCA9IHV0aWxzLmdldFF1ZXJ5U3RyaW5nKCdyaWQnKTtcclxuICAgICAgICAgICAgZ2FtZWRhdGEudG9rZW4gPSB1dGlscy5nZXRRdWVyeVN0cmluZygndG9rZW4nKTtcclxuICAgICAgICAgICAgaWYgKCFnYW1lZGF0YS5yaWQgfHwgIWdhbWVkYXRhLnRva2VuKSB7XHJcbiAgICAgICAgICAgICAgICB1dGlscy5hZGRUaXBzKCflj4LmlbDplJnor68nKTtcclxuICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB0aGlzLmxvZ2luKCk7XHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuICAgIGxvZ2luKCkge1xyXG4gICAgICAgIGxldCBwcmVhcyA9IHtcclxuICAgICAgICAgICAgcmlkOiBnYW1lZGF0YS5yaWQsXHJcbiAgICAgICAgICAgIHRva2VuOiBnYW1lZGF0YS50b2tlbixcclxuICAgICAgICB9O1xyXG4gICAgICAgIFVJSGVscC5uZXR3b3JrLmh0dHBTZW5kKCdnYW1lL3hpYW94aWFvbGUvZ2V0R2FtZUluZm8nLCBwcmVhcywgdGhpcy5sb2dpbkNhbGwuYmluZCh0aGlzKSk7XHJcbiAgICB9LFxyXG4gICAgbG9naW5DYWxsKG1zZykge1xyXG4gICAgICAgIGNvbnNvbGUubG9nKCdsb2dpbj09PicsIG1zZyk7XHJcbiAgICAgICAgaWYgKG1zZy5jb2RlID09IDIwMCkge1xyXG4gICAgICAgICAgICBnYW1lZGF0YS5Mdl9zdGFyID0gTnVtYmVyKG1zZy5kYXRhLmN1cnJlbnRfbGV2ZWwpO1xyXG4gICAgICAgICAgICAvLyBnYW1lZGF0YS5Mdl9zdGFyID0gNzQ7XHJcbiAgICAgICAgICAgIGdhbWVkYXRhLmxldmVsX3N0YXJzID0gbXNnLmRhdGEubGV2ZWxfc3RhcnM7XHJcbiAgICAgICAgICAgIC8v5b2T5YmN6YeR5biB5pWw6YePXHJcbiAgICAgICAgICAgIGdhbWVkYXRhLmdvbGQgPSBOdW1iZXIobXNnLmRhdGEuY29pbik7XHJcbiAgICAgICAgICAgIC8v5b2T5YmN57K+5YqbXHJcbiAgICAgICAgICAgIGdhbWVkYXRhLmVuZXJneSA9IE51bWJlcihtc2cuZGF0YS5lbmVyZ3kpO1xyXG4gICAgICAgICAgICBsZXQgcHJlYXMgPSB7XHJcbiAgICAgICAgICAgICAgICByaWQ6IGdhbWVkYXRhLnJpZCxcclxuICAgICAgICAgICAgICAgIHRva2VuOiBnYW1lZGF0YS50b2tlbixcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgVUlIZWxwLm5ldHdvcmsuaHR0cENvbm5lY3RfcG9zdF9hc3luYyhcclxuICAgICAgICAgICAgICAgICdnYW1lL3hpYW94aWFvbGUvZ2V0TXlQcm9wTGlzdCcsXHJcbiAgICAgICAgICAgICAgICBwcmVhcyxcclxuICAgICAgICAgICAgICAgIHRoaXMuZ2V0TXlQcm9wTGlzdENhbGxCYWNrLmJpbmQodGhpcylcclxuICAgICAgICAgICAgKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICB1dGlscy5hZGRUaXBzKG1zZy5tZXNzYWdlKTtcclxuICAgICAgICB9XHJcbiAgICB9LFxyXG5cclxuICAgIGdldE15UHJvcExpc3RDYWxsQmFjayhtc2cpIHtcclxuICAgICAgICBjb25zb2xlLmxvZygnZ2V0bXlQcnJvcExpc3Q9PT09PicsIG1zZyk7XHJcbiAgICAgICAgaWYgKG1zZy5jb2RlID09IDIwMCkge1xyXG4gICAgICAgICAgICBpZiAobXNnLmRhdGEubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICAgICAgZm9yIChsZXQgYSA9IDA7IGEgPCBtc2cuZGF0YS5sZW5ndGg7IGErKykge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChtc2cuZGF0YVthXS5naWQgPT0gMTAwMDEpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZ2FtZWRhdGEucHJvcFsxXSA9IE51bWJlcihtc2cuZGF0YVthXS5udW0pO1xyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAobXNnLmRhdGFbYV0uZ2lkID09IDEwMDAyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGdhbWVkYXRhLnByb3BbM10gPSBOdW1iZXIobXNnLmRhdGFbYV0ubnVtKTtcclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKG1zZy5kYXRhW2FdLmdpZCA9PSAxMDAwMykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBnYW1lZGF0YS5wcm9wWzRdID0gTnVtYmVyKG1zZy5kYXRhW2FdLm51bSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHRoaXMucHJlTG9hZGluZygpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHV0aWxzLmFkZFRpcHMobXNnLm1lc3NhZ2UpO1xyXG4gICAgICAgIH1cclxuICAgIH0sXHJcbiAgICAvL+mihOWFiOWKoOi9vei1hOa6kFxyXG4gICAgcHJlTG9hZGluZygpIHtcclxuICAgICAgICBsZXQgc2VsZiA9IHRoaXM7XHJcbiAgICAgICAgLy8gc2VsZi50aXBMYWJlbFsxXS5zdHJpbmcgPSBcIuato+WcqOWKoOi9vei1hOa6kC4uLi4uLlwiO1xyXG4gICAgICAgIHNlbGYuaXNfTG9hZGluZyA9IHRydWU7XHJcbiAgICAgICAgbGV0IG9uUHJvY2VzcyA9IGZ1bmN0aW9uIChjb21wbGV0ZWNvdW50LCB0b3RhbGNvdW50LCBpdGVtKSB7XHJcbiAgICAgICAgICAgIGlmIChzZWxmLmlzX0xvYWRpbmcpIHtcclxuICAgICAgICAgICAgICAgIGxldCBwcm9ncmVzcyA9IChjb21wbGV0ZWNvdW50IC8gdG90YWxjb3VudCkgKiAwLjU7XHJcbiAgICAgICAgICAgICAgICBzZWxmLnRpcExhYmVsWzBdLnN0cmluZyA9IE1hdGguZmxvb3IocHJvZ3Jlc3MgKiAxMDApICsgJyUnO1xyXG4gICAgICAgICAgICAgICAgLy9jb25zb2xlLmxvZyhwcm9ncmVzcyk7XHJcbiAgICAgICAgICAgICAgICBzZWxmLnByb19sb2FkaW5nLnByb2dyZXNzID0gcHJvZ3Jlc3M7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG4gICAgICAgIGxldCBvblByb2Nlc3MxID0gZnVuY3Rpb24gKGNvbXBsZXRlY291bnQsIHRvdGFsY291bnQsIGl0ZW0pIHtcclxuICAgICAgICAgICAgaWYgKHNlbGYuaXNfTG9hZGluZykge1xyXG4gICAgICAgICAgICAgICAgbGV0IHByb2dyZXNzID0gKGNvbXBsZXRlY291bnQgLyB0b3RhbGNvdW50KSAqIDAuNSArIDAuNTtcclxuICAgICAgICAgICAgICAgIHNlbGYudGlwTGFiZWxbMF0uc3RyaW5nID0gTWF0aC5mbG9vcihwcm9ncmVzcyAqIDEwMCkgKyAnJSc7XHJcbiAgICAgICAgICAgICAgICAvL2NvbnNvbGUubG9nKHByb2dyZXNzKTtcclxuICAgICAgICAgICAgICAgIHNlbGYucHJvX2xvYWRpbmcucHJvZ3Jlc3MgPSBwcm9ncmVzcztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcbiAgICAgICAgY2MuZGlyZWN0b3IucHJlbG9hZFNjZW5lKCduZXdMZXZlbCcsIG9uUHJvY2VzcywgKCkgPT4ge1xyXG4gICAgICAgICAgICBjYy5kaXJlY3Rvci5wcmVsb2FkU2NlbmUoJ05ld01haW4nLCBvblByb2Nlc3MxLCAoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICBzZWxmLmlzX0xvYWRpbmcgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoXHJcbiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjYy5kaXJlY3Rvci5sb2FkU2NlbmUoJ25ld0xldmVsJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgfS5iaW5kKHRoaXMpLFxyXG4gICAgICAgICAgICAgICAgICAgIDEwMDBcclxuICAgICAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIC8vIGNjLmxvYWRlci5sb2FkUmVzRGlyKFwidGV4dHVyZVwiLCBvblByb2Nlc3MsIGZ1bmN0aW9uIChlcnIsIGFzc2V0cykge1xyXG4gICAgICAgIC8vICAgICBpZiAoZXJyKSB7XHJcbiAgICAgICAgLy8gICAgICAgICBzZWxmLnRpcExhYmVsWzFdLnN0cmluZyA9IFwi5Yqg6L296LWE5rqQ6ZSZ6K+vXCI7XHJcbiAgICAgICAgLy8gICAgIH0gZWxzZSB7XHJcbiAgICAgICAgLy8gICAgICAgICBzZWxmLmlzX0xvYWRpbmcgPSBmYWxzZTtcclxuICAgICAgICAvLyAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIC8vICAgICAgICAgICAgIGNjLmRpcmVjdG9yLmxvYWRTY2VuZShcIm5ld0xldmVsXCIpO1xyXG4gICAgICAgIC8vICAgICAgICAgfS5iaW5kKHRoaXMpLCAxMDAwKTtcclxuICAgICAgICAvLyAgICAgICAgIC8vIHNlbGYudGlwTGFiZWxbMV0uc3RyaW5nID0gXCLliqDovb3lhbPljaHotYTmupAuLi4uLi4uXCI7XHJcbiAgICAgICAgLy8gICAgICAgICAvLyBjYy5sb2FkZXIubG9hZFJlc0RpcignbGV2ZWxzJywgY2MuVGV4dEFzc2V0LCAoZXJyLCByZXMpID0+IHtcclxuICAgICAgICAvLyAgICAgICAgIC8vICAgICBpZiAoZXJyKSB7XHJcbiAgICAgICAgLy8gICAgICAgICAvLyAgICAgICAgIGNvbnNvbGUubG9nKFwibG9hZCByZXMgZXJyb3I9XCIgKyBlcnIpO1xyXG4gICAgICAgIC8vICAgICAgICAgLy8gICAgIH0gZWxzZSB7XHJcbiAgICAgICAgLy8gICAgICAgICAvLyAgICAgICAgIC8vIGdhbWVkYXRhLkx2X3N0YXIgPSByZXMubGVuZ3RoIC0gMTtcclxuICAgICAgICAvLyAgICAgICAgIC8vICAgICAgICAgLy8gY29uc29sZS5sb2coJ3NkYWZzZGZhJywgZ2FtZWRhdGEuTHZfc3RhcilcclxuICAgICAgICAvLyAgICAgICAgIC8vICAgICAgICAgc2VsZi50aXBMYWJlbFsxXS5zdHJpbmcgPSBcIuWKoOi9vei1hOa6kOaIkOWKn++8jOato+WcqOi/m+WFpea4uOaIj1wiO1xyXG4gICAgICAgIC8vICAgICAgICAgLy8gICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAvLyAgICAgICAgIC8vICAgICAgICAgICAgIGNjLmRpcmVjdG9yLmxvYWRTY2VuZShcIm5ld0xldmVsXCIpO1xyXG4gICAgICAgIC8vICAgICAgICAgLy8gICAgICAgICB9LmJpbmQodGhpcyksIDEwMDApO1xyXG4gICAgICAgIC8vICAgICAgICAgLy8gICAgIH1cclxuICAgICAgICAvLyAgICAgICAgIC8vIH0pXHJcblxyXG4gICAgICAgIC8vICAgICB9XHJcbiAgICAgICAgLy8gfSlcclxuICAgIH0sXHJcbn0pO1xyXG4iXX0=