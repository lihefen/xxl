{"version":3,"sources":["assets/newscripts/Level/Level.js"],"names":["com","require","cc","Class","Component","properties","energyprogress","ProgressBar","energyLabel","Label","goldLabel","mask","Node","shopPrefab","Prefab","shop","rank","onLoad","ZL","Level","gamedata","bg_music","audioEngine","resumeAll","start","string","energy","progress","update","dt","gold","openShop","instantiate","node","addChild","setPosition","getComponent","Open","OpenMask","active","closeMask","console","log","onDestroy","share","WxShare","onOpenRank"],"mappings":"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","sourceRoot":"/","sourcesContent":["var com=require('Common');\r\ncc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n            //精力条\r\n            energyprogress:cc.ProgressBar,\r\n            energyLabel:cc.Label,\r\n            //金币框\r\n            goldLabel:cc.Label,\r\n            //星星框\r\n            //starLabel:cc.Label,\r\n\r\n            //遮罩\r\n            mask:cc.Node,\r\n            //商店预制体\r\n            shopPrefab:cc.Prefab,\r\n            shop:null,\r\n            rank: cc.Prefab,\r\n    },\r\n\r\n    onLoad () {\r\n        if(cc.ZL==null){\r\n            cc.ZL={};\r\n        }\r\n        cc.ZL.Level=this;\r\n        if(gamedata.bg_music){\r\n            cc.audioEngine.resumeAll();\r\n        }\r\n    },\r\n\r\n    start () {\r\n        // this.closeMask();\r\n        //查看可以回复多少体力\r\n        // let num=Date.now();\r\n        // if(gamedata.energy<30){\r\n        //     //查看回复体力的时间差(5分钟回复一体力)\r\n        //     //console.log(num-gamedata.timer);\r\n        //     let scend=Math.floor((num-gamedata.timer)/100000);\r\n        //     //console.log(scend);\r\n        //     if(scend>1){\r\n        //         gamedata.energy +=scend;\r\n        //         if(gamedata.energy>30){\r\n        //             gamedata.energy=30;\r\n        //         }\r\n        //         gamedata.timer=Date.now();\r\n        //         gamedata.bc_energy();\r\n        //         gamedata.bc_timer();\r\n        //     }\r\n           \r\n        // }else{\r\n        //     gamedata.timer=Date.now();\r\n        //     gamedata.bc_energy();\r\n        //     gamedata.bc_timer(); \r\n        // }\r\n        // console.log('123123123123', gamedata.energy)\r\n        this.energyLabel.string=gamedata.energy;\r\n        this.energyprogress.progress=gamedata.energy/30;\r\n    },\r\n\r\n    update (dt) {\r\n        this.goldLabel.string=gamedata.gold;\r\n        this.energyLabel.string=gamedata.energy;\r\n        this.energyprogress.progress=gamedata.energy/30;\r\n        \r\n    },\r\n    //打开商店\r\n    openShop(){\r\n        if(this.shop==null){\r\n            this.shop=cc.instantiate(this.shopPrefab);\r\n            this.node.addChild(this.shop);\r\n            this.shop.setPosition(0,2000);\r\n        }\r\n        this.shop.getComponent(\"Shop\").Open();\r\n        this.OpenMask();\r\n    },\r\n    //打开遮罩\r\n    OpenMask(){\r\n        this.mask.active=true;\r\n        // this.mask.runAction(cc.fadeTo(0.2,200));\r\n    },\r\n    //关闭遮罩\r\n    closeMask(){\r\n        console.log('closeMask')\r\n        this.mask.active=false;\r\n        // this.mask.opacity=0;\r\n    },\r\n    onDestroy(){\r\n        cc.ZL.Level=null;\r\n    },\r\n\r\n    share(){\r\n        com.WxShare();\r\n    },\r\n\r\n    onOpenRank() {\r\n        let node =cc.instantiate(this.rank);\r\n        this.node.addChild(node);\r\n        this.OpenMask();\r\n    }\r\n});\r\n"]}