{"version":3,"sources":["assets/newscripts/rankLayer.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["// Learn TypeScript:\n//  - [Chinese] https://docs.cocos.com/creator/manual/zh/scripting/typescript.html\n//  - [English] http://www.cocos2d-x.org/docs/creator/manual/en/scripting/typescript.html\n// Learn Attribute:\n//  - [Chinese] https://docs.cocos.com/creator/manual/zh/scripting/reference/attributes.html\n//  - [English] http://www.cocos2d-x.org/docs/creator/manual/en/scripting/reference/attributes.html\n// Learn life-cycle callbacks:\n//  - [Chinese] https://docs.cocos.com/creator/manual/zh/scripting/life-cycle-callbacks.html\n//  - [English] http://www.cocos2d-x.org/docs/creator/manual/en/scripting/life-cycle-callbacks.html\n\nimport { Utilities } from \"winjs\";\nimport item_rank from \"./item_rank\";\nimport { UIHelp } from \"./UIHelp\";\n\nconst {ccclass, property} = cc._decorator;\n\n@ccclass\nexport default class rankLayer extends cc.Component {\n\n    @property({type: cc.Prefab, displayName: '排行item'})\n    item: cc.Prefab = null;\n    @property({type: cc.Node, displayName: '关卡Label'})\n    lab_guanka: cc.Node = null;\n    @property({type: cc.Node, displayName: '积分Label'})\n    lab_jifen: cc.Node = null;\n\n    @property({type: cc.Label, displayName: '排名'})\n    rank: cc.Label = null;\n    @property({type: cc.Sprite, displayName: '头像'})\n    icon: cc.Sprite = null;\n    @property({type: cc.Label, displayName: '昵称'})\n    nickname: cc.Label = null;\n    @property({type: cc.Label, displayName: '分数'})\n    fen: cc.Label = null;\n\n    @property({type: cc.Node, displayName: '滑块content'})\n    content: cc.Node = null;\n\n\n    tag1: number = 0;\n    tag2: number = 0;\n    start () {\n        this.onGetData();\n    }\n\n    onGetData() {\n        let params = {\n            rid: gamedata.rid,\n            token: gamedata.token,\n            type: 0\n        }\n        utils.ShowLoading();\n        UIHelp.network.httpSend('game/xiaoxiaole/getGralRankList', params, this.GetCallBack.bind(this))\n    }\n\n    GetCallBack(msg) {\n        console.log('rank===>', msg);\n        utils.HideLoading();\n        if(msg.code == 200) {\n            this.onStartUser(msg);\n            if(msg.data.list.length > 0) {\n                this.content.removeAllChildren();\n                for(let a = 0; a < msg.data.list.length; a++) {\n                    let node = cc.instantiate(this.item);\n                    node.getComponent(item_rank).onStartInfo(msg.data.list[a]);\n                    node.parent = this.content;\n                }\n            }\n        }else{\n            utils.addTips(msg.message);\n        }\n    }\n\n    onStartUser(msg) {\n        msg.data.rank_num? this.rank.string = msg.data.rank_num : this.rank.node.active = false;\n        if(msg.data.headimage) {\n            cc.loader.load(msg.data.headimage, (err, img) => {\n                if(err) {\n                    utils.addTips(\"头像加载失败\")\n                }\n                let sprite = new cc.SpriteFrame(img);\n                this.icon.spriteFrame = sprite;\n            })\n        }else{\n            this.icon.node.active = false;\n        }\n        let name;\n        if(msg.data.nickname.length > 6) {\n            name = msg.data.nickname.slice(0,6) + '...';\n        }else{\n            name = msg.data.nickname;\n        }\n        msg.data.nickname?  this.nickname.string = name : this.nickname.node.active = false;\n        msg.data.points? this.fen.string = msg.data.points : this.fen.node.active = false;\n    }\n\n    onClickZhiBo() {\n        this.tag1 = 0;\n        this.onSelectTag();\n    }\n\n    onClickPingTai() {\n        this.tag1 = 1;\n        this.onSelectTag();\n    }\n\n    onClickJiFen() {\n        this.tag2 = 0;\n        this.lab_jifen.active = true;\n        this.lab_guanka.active = false;\n        this.onSelectTag();\n    }\n\n    onClickGuanKa() {\n        this.tag2 = 1;\n        this.lab_jifen.active = false;\n        this.lab_guanka.active = true;\n        this.onSelectTag();\n    }\n\n    onSelectTag() {\n        if(this.tag1 == 0) {\n            if(this.tag2 == 0) {\n                let params = {\n                    rid: gamedata.rid,\n                    token: gamedata.token,\n                    type: 0\n                }\n                utils.ShowLoading();\n                UIHelp.network.httpSend('game/xiaoxiaole/getGralRankList', params, this.GetCallBack.bind(this))\n                \n            }else{\n                let params = {\n                    rid: gamedata.rid,\n                    token: gamedata.token,\n                    type: 0\n                }\n                utils.ShowLoading();\n                UIHelp.network.httpSend('game/xiaoxiaole/getLevelRankList', params, this.GetCallBack.bind(this))\n            }\n        }else{\n            if(this.tag2 == 0) {\n                let params = {\n                    rid: gamedata.rid,\n                    token: gamedata.token,\n                    type: 1\n                }\n                utils.ShowLoading();\n                UIHelp.network.httpSend('game/xiaoxiaole/getGralRankList', params, this.GetCallBack.bind(this))\n            }else{\n                let params = {\n                    rid: gamedata.rid,\n                    token: gamedata.token,\n                    type: 1\n                }\n                utils.ShowLoading();\n                UIHelp.network.httpSend('game/xiaoxiaole/getLevelRankList', params, this.GetCallBack.bind(this))\n            }\n        }\n    }\n\n    onClose() {\n        if(cc.ZL.Level){\n            cc.ZL.Level.closeMask();\n        }\n        this.node.removeFromParent(true);\n    }\n\n    // update (dt) {}\n}\n"]}