{"version":3,"sources":["assets/newscripts/Main/End.js"],"names":["com","require","UIHelp","cc","Class","Component","properties","mask","Node","lab_num","onLoad","num","start","InitView","msg","Number","getComponent","Label","string","node","runAction","scaleTo","setTimeout","opacity","bind","AddFive","WxShare","comeInfo","is_share","ZL","animMgr","active","musicMgr","MyplayMusic","UIMgr","AddFiveStep","destroy","AddTwo","gamedata","gold","preas","rid","token","gid","console","log","consumePropCallBack","code","bc_gold","AddTwoStep","utils","addTips","message","Replay","event","getChildByName","Button","interactable","energy","level","lvdata","lvl","network","httpSend","playGameCall","director","loadScene","game_code","data","coin","Close"],"mappings":"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","sourceRoot":"/","sourcesContent":["var com = require('Common');\r\nconst { UIHelp } = require('../UIHelp');\r\ncc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        mask: cc.Node,\r\n        lab_num: cc.Node,\r\n    },\r\n\r\n    onLoad() {\r\n        this.num = 0;\r\n    },\r\n\r\n    start() {},\r\n\r\n    // update (dt) {},\r\n    InitView(msg) {\r\n        this.num = Number(msg);\r\n        this.lab_num.getComponent(cc.Label).string = msg;\r\n        this.node.runAction(cc.scaleTo(0.2, 1, 1));\r\n        setTimeout(\r\n            function () {\r\n                if (this.node) {\r\n                    this.mask.opacity = 100;\r\n                }\r\n            }.bind(this),\r\n            300\r\n        );\r\n    },\r\n    //看视频加5步\r\n    AddFive() {\r\n        com.WxShare();\r\n        setTimeout(\r\n            function () {\r\n                if (comeInfo.is_share) {\r\n                    if (this.node) {\r\n                        cc.ZL.animMgr.mask.active = false;\r\n                        cc.ZL.musicMgr.MyplayMusic(0, false);\r\n                        cc.ZL.UIMgr.AddFiveStep();\r\n                        this.mask.opacity = 1;\r\n                        this.node.runAction(cc.scaleTo(0.2, 0, 0));\r\n                        setTimeout(\r\n                            function () {\r\n                                if (this.node) {\r\n                                    this.node.destroy();\r\n                                }\r\n                            }.bind(this),\r\n                            300\r\n                        );\r\n                        comeInfo.is_share = false;\r\n                    }\r\n                }\r\n            }.bind(this),\r\n            3500\r\n        );\r\n    },\r\n    //金币加2步\r\n    AddTwo() {\r\n        if (gamedata.gold > 20) {\r\n            if (this.node) {\r\n                let preas = {\r\n                    rid: gamedata.rid,\r\n                    token: gamedata.token,\r\n                    gid: 10004,\r\n                    num: 1,\r\n                };\r\n                console.log('金币加两步');\r\n                // TODO:先注释掉\r\n                this.consumePropCallBack({\r\n                    code: '200',\r\n                });\r\n                // UIHelp.network.httpConnect_post_async(\r\n                //     'game/xiaoxiaole/consumeProp',\r\n                //     preas,\r\n                //     this.consumePropCallBack.bind(this)\r\n                // );\r\n\r\n                //     cc.ZL.animMgr.mask.active=false;\r\n                //     gamedata.gold-=20;\r\n                //     gamedata.bc_gold();\r\n                //     cc.ZL.musicMgr.MyplayMusic(0,false);\r\n                //     cc.ZL.UIMgr.AddTwoStep();\r\n                //     this.mask.opacity=1;\r\n                //     this.node.runAction(cc.scaleTo(0.2,0,0));\r\n                //     setTimeout(function(){\r\n                //         if(this.node){\r\n                //             this.node.destroy();\r\n                //         }\r\n                //     }.bind(this),300);\r\n            }\r\n        }\r\n    },\r\n\r\n    consumePropCallBack(msg) {\r\n        console.log('金币加两部===>', msg);\r\n        if (msg.code == 200) {\r\n            cc.ZL.animMgr.mask.active = false;\r\n            gamedata.gold -= this.num;\r\n            gamedata.bc_gold();\r\n            cc.ZL.musicMgr.MyplayMusic(0, false);\r\n            cc.ZL.UIMgr.AddTwoStep();\r\n            this.mask.opacity = 1;\r\n            this.node.runAction(cc.scaleTo(0.2, 0, 0));\r\n            setTimeout(\r\n                function () {\r\n                    if (this.node) {\r\n                        this.node.destroy();\r\n                    }\r\n                }.bind(this),\r\n                300\r\n            );\r\n        } else {\r\n            utils.addTips(msg.message);\r\n        }\r\n    },\r\n\r\n    //重玩本关\r\n    Replay(event) {\r\n        this.node.getChildByName('again').getComponent(cc.Button).interactable = false;\r\n        if (gamedata.energy >= 5) {\r\n            let preas = {\r\n                rid: gamedata.rid,\r\n                token: gamedata.token,\r\n                level: lvdata.lvl,\r\n            };\r\n            UIHelp.network.httpSend('game/xiaoxiaole/playGame', preas, this.playGameCall.bind(this));\r\n        } else {\r\n            utils.addTips('体力不足');\r\n            cc.director.loadScene('newLevel');\r\n        }\r\n\r\n        // cc.ZL.musicMgr.MyplayMusic(0, false);\r\n        // if (gamedata.energy >= 5) {\r\n        //     gamedata.energy -= 5;\r\n        //     gamedata.bc_energy();\r\n        //     cc.director.loadScene(\"NewMain\");\r\n        // } else {\r\n        //     cc.director.loadScene(\"newLevel\");\r\n        //     // utils.addTips('体力不足');\r\n        // }\r\n    },\r\n    playGameCall(msg) {\r\n        console.log('playgame===>', msg);\r\n        if (msg.code == 200) {\r\n            gamedata.game_code = msg.data.game_code;\r\n            //当前金币数量\r\n            gamedata.gold = Number(msg.data.coin);\r\n            //当前精力\r\n            gamedata.energy = Number(msg.data.energy);\r\n            cc.ZL.musicMgr.MyplayMusic(0, false);\r\n            cc.director.loadScene('NewMain');\r\n        } else {\r\n            utils.addTips(msg.message);\r\n            this.node.getChildByName('again').getComponent(cc.Button).interactable = true;\r\n        }\r\n    },\r\n    Close() {\r\n        this.node.getChildByName('again').getComponent(cc.Button).interactable = false;\r\n        cc.ZL.musicMgr.MyplayMusic(0, false);\r\n        cc.director.loadScene('newLevel');\r\n    },\r\n});\r\n"]}