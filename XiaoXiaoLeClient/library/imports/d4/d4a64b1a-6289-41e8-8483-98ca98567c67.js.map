{"version":3,"sources":["assets/newscripts/Level/LvTarget.js"],"names":["require","UIHelp","cc","Class","Component","properties","lvLabel","Label","lv","target","Sprite","energy","Node","energylogo","tip","Prefab","music","type","AudioClip","onLoad","ZL","Target","opacity","start","InitView","num","gamedata","audioEngine","play","comeInfo","now_lv","Level","OpenMask","string","T","lvdata","i","length","spriteFrame","sprMgr","spr","icespr","node","active","y","find","height","runAction","moveTo","v2","easing","easeBackOut","close","closeMask","BeginGame","console","log","a","instantiate","parent","addChild","getComponent","preas","rid","token","level","playGameCall","code","data","coin","msg","game_code","gold","Number","pos","convertToWorldSpaceAR","getPosition","pos1","convertToNodeSpaceAR","setPosition","setTimeout","director","loadScene","bind","utils","addTips","message"],"mappings":"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","sourceRoot":"/","sourcesContent":["const { UIHelp } = require('../UIHelp');\r\ncc.Class({\r\n    extends: cc.Component,\r\n    properties: {\r\n        //关卡显示框\r\n        lvLabel: cc.Label,\r\n        //要玩第几关关\r\n        lv: 1,\r\n        //目标\r\n        target: [cc.Sprite],\r\n        //精力图标\r\n        energy: cc.Node,\r\n        energylogo: cc.Node,\r\n        //tip\r\n        tip: cc.Prefab,\r\n        music: {\r\n            type: cc.AudioClip,\r\n            default: [],\r\n        },\r\n    },\r\n    onLoad() {\r\n        cc.ZL.Target = this;\r\n        this.energylogo.opacity = 0;\r\n    },\r\n\r\n    start() {},\r\n\r\n    // update (dt) {},\r\n    InitView(num) {\r\n        if (gamedata.music) {\r\n            cc.audioEngine.play(this.music[0], false, 1);\r\n        }\r\n        (this.lv = num), (comeInfo.now_lv = num);\r\n        cc.ZL.Level.OpenMask();\r\n        this.lvLabel.string = '第' + this.lv + '关';\r\n        // let T=lvdata[\"Lv\"+comeInfo.now_lv].target;\r\n        let T = lvdata.target;\r\n        for (let i = 0; i < this.target.length; i++) {\r\n            if (i < T.length) {\r\n                if (T[i][0] < 10) {\r\n                    this.target[i].spriteFrame = cc.ZL.sprMgr.spr[T[i][0]];\r\n                } else {\r\n                    this.target[i].spriteFrame = cc.ZL.sprMgr.icespr[T[i][0] - 10];\r\n                }\r\n                this.target[i].node.active = true;\r\n            } else {\r\n                this.target[i].node.active = false;\r\n            }\r\n        }\r\n        let y = cc.find('Canvas').height / 2 - this.node.height / 2;\r\n        this.node.runAction(cc.moveTo(0.2, cc.v2(0, y), 0).easing(cc.easeBackOut()));\r\n    },\r\n    close() {\r\n        if (gamedata.music) {\r\n            cc.audioEngine.play(this.music[0], false, 1);\r\n        }\r\n        cc.ZL.Level.closeMask();\r\n        this.energylogo.opacity = 0;\r\n        this.node.runAction(cc.moveTo(0.2, 0, 2000));\r\n    },\r\n    //开始游戏\r\n    BeginGame() {\r\n        console.log('BeginGame');\r\n        if (gamedata.energy < 5) {\r\n            let a = cc.instantiate(this.tip);\r\n            this.node.parent.addChild(a);\r\n            a.getComponent('tip').InitView(2);\r\n            return;\r\n        }\r\n        if (gamedata.music) {\r\n            cc.audioEngine.play(this.music[1], false, 1);\r\n        }\r\n\r\n        let preas = {\r\n            rid: gamedata.rid,\r\n            token: gamedata.token,\r\n            level: this.lv,\r\n        };\r\n\r\n        // TODO:先注释\r\n        this.playGameCall({\r\n            code: '200',\r\n            data: {\r\n                coin: '10',\r\n                energy: '10',\r\n            },\r\n        });\r\n        // UIHelp.network.httpSend('game/xiaoxiaole/playGame', preas, this.playGameCall.bind(this));\r\n\r\n        // gamedata.energy -=5;\r\n        // gamedata.bc_energy();\r\n        // //获取到精力图标的位置\r\n        // var pos=this.energy.parent.convertToWorldSpaceAR(this.energy.getPosition());\r\n        // //转换到父物体的位置\r\n        // var pos1=this.energylogo.parent.convertToNodeSpaceAR(pos);\r\n        // this.energylogo.setPosition(pos1);\r\n        // this.energylogo.opacity=255;\r\n        // this.energylogo.runAction(cc.moveTo(0.5,27,-358));\r\n        // setTimeout(function(){\r\n        //     if(gamedata.music){\r\n        //         cc.audioEngine.play(this.music[2],false,1);\r\n        //     }\r\n        //     //cc.ZL.lvMgr.MyplayMusic(2,false);\r\n        //     cc.director.loadScene(\"NewMain\");\r\n        // }.bind(this),600);\r\n    },\r\n\r\n    playGameCall(msg) {\r\n        console.log('playgame===>', msg);\r\n        if (msg.code == 200) {\r\n            gamedata.game_code = msg.data.game_code;\r\n            // gamedata.energy -= 5;\r\n            // gamedata.bc_energy();\r\n            //当前金币数量\r\n            gamedata.gold = Number(msg.data.coin);\r\n            //当前精力\r\n            gamedata.energy = Number(msg.data.energy);\r\n            //获取到精力图标的位置\r\n            var pos = this.energy.parent.convertToWorldSpaceAR(this.energy.getPosition());\r\n            //转换到父物体的位置\r\n            var pos1 = this.energylogo.parent.convertToNodeSpaceAR(pos);\r\n            this.energylogo.setPosition(pos1);\r\n            this.energylogo.opacity = 255;\r\n            this.energylogo.runAction(cc.moveTo(0.5, 27, -358));\r\n            setTimeout(\r\n                function () {\r\n                    if (gamedata.music) {\r\n                        cc.audioEngine.play(this.music[2], false, 1);\r\n                    }\r\n                    //cc.ZL.lvMgr.MyplayMusic(2,false);\r\n                    cc.director.loadScene('NewMain');\r\n                }.bind(this),\r\n                600\r\n            );\r\n        } else {\r\n            utils.addTips(msg.message);\r\n        }\r\n    },\r\n});\r\n"]}