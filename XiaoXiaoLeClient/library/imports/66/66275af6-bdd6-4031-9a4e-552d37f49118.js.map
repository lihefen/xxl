{"version":3,"sources":["assets/newscripts/Mains/QQ.js"],"names":["cc","Class","Component","properties","rowNum","columnNum","type","typenum","start","InitQQ","row","column","node","setPosition","utils","rowColumnPosition","ZL","animMgr","animalArray","can_move","i","lvdata","target","length","QQMove","stopAllActions","nextanim","RandAnim","arow","acolumn","iceMgr","UpArray","runAction","jumpTo","comeInfo","qqmoveTime","around","Array","anim","animType","push","Toanim","Math","floor","random","clear","qqmoveNum","targetMgr","clearTarget","destroy"],"mappings":"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","sourceRoot":"/","sourcesContent":["\r\ncc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        rowNum: -1,\r\n        columnNum: -1,\r\n        type: -1,\r\n        typenum: -1,\r\n    },\r\n\r\n    // onLoad () {},\r\n    start() {\r\n\r\n    },\r\n\r\n    // update (dt) {},\r\n    InitQQ(row, column, type) {\r\n        this.rowNum = row;\r\n        this.columnNum = column;\r\n        this.type = type;\r\n        this.node.setPosition(utils.rowColumnPosition(column, row));\r\n        cc.ZL.animMgr.animalArray[this.rowNum][this.columnNum].can_move = false;\r\n        // for(let i=0;i<lvdata[\"Lv\"+comeInfo.now_lv].target.length;i++){\r\n        //     if(lvdata[\"Lv\"+comeInfo.now_lv].target[i][0]==this.type){\r\n        for (let i = 0; i < lvdata.target.length; i++) {\r\n            if (lvdata.target[i][0] == this.type) {\r\n                this.typenum = i;\r\n            }\r\n        }\r\n    },\r\n    QQMove() {\r\n        //有可能连续两次移动\r\n        this.node.stopAllActions();\r\n        let nextanim = this.RandAnim();\r\n        if (nextanim != null) {\r\n            //获取要移动到的位置\r\n            let arow = nextanim.rowNum;\r\n            let acolumn = nextanim.columnNum;\r\n\r\n            //先清空在旧数组中的位置\r\n            cc.ZL.iceMgr.UpArray[this.rowNum][this.columnNum] = 0;\r\n            //将那个位置的动物设为可移动\r\n            cc.ZL.animMgr.animalArray[this.rowNum][this.columnNum].can_move = true;\r\n            //将要移动到下个位置设为这个对象\r\n            cc.ZL.iceMgr.UpArray[arow][acolumn] = this;\r\n            //将要移动到下个位置的动物设为不可移动\r\n            cc.ZL.animMgr.animalArray[arow][acolumn].can_move = false;\r\n            this.node.runAction(cc.jumpTo(comeInfo.qqmoveTime, utils.rowColumnPosition(acolumn, arow), 50, 1));\r\n            this.rowNum = arow;\r\n            this.columnNum = acolumn;\r\n        } else {\r\n            //console.log(\"不可移动\");\r\n        }\r\n    },\r\n    //随机选择周围的一个动物\r\n    RandAnim() {\r\n        let around = new Array();\r\n        //上\r\n        if (this.rowNum - 1 >= 0) {\r\n            let anim = cc.ZL.animMgr.animalArray[this.rowNum - 1][this.columnNum];\r\n            if (anim != 0 && anim != -1) {\r\n                if (anim.animType > 0 && anim.animType <= 6 && anim.can_move) {\r\n                    around.push(anim);\r\n                }\r\n            }\r\n        }\r\n        //下\r\n        if (this.rowNum + 1 < comeInfo.column) {\r\n            let anim = cc.ZL.animMgr.animalArray[this.rowNum + 1][this.columnNum];\r\n            if (anim != 0 && anim != -1) {\r\n                if (anim.animType > 0 && anim.animType <= 6 && anim.can_move) {\r\n                    around.push(anim);\r\n                }\r\n            }\r\n        }\r\n        //左\r\n        if (this.columnNum - 1 >= 0) {\r\n            let anim = cc.ZL.animMgr.animalArray[this.rowNum][this.columnNum - 1];\r\n            if (anim != 0 && anim != -1) {\r\n                if (anim.animType > 0 && anim.animType <= 6 && anim.can_move) {\r\n                    around.push(anim);\r\n                }\r\n            }\r\n        }\r\n        //右\r\n        if (this.columnNum + 1 < comeInfo.row) {\r\n            let anim = cc.ZL.animMgr.animalArray[this.rowNum][this.columnNum + 1];\r\n            if (anim != 0 && anim != -1) {\r\n                if (anim.animType > 0 && anim.animType <= 6 && anim.can_move) {\r\n                    around.push(anim);\r\n                }\r\n            }\r\n        }\r\n        //如果周围有可以移动的\r\n        if (around.length > 0) {\r\n            let Toanim = around[Math.floor(Math.random() * around.length)];\r\n            return Toanim;\r\n        } else {\r\n            return null;\r\n        }\r\n    },\r\n    clear() {\r\n        if (this.type == 13) {\r\n            cc.ZL.iceMgr.qqmoveNum -= 1;\r\n            cc.ZL.animMgr.animalArray[this.rowNum][this.columnNum].can_move = true;\r\n            cc.ZL.iceMgr.UpArray[this.rowNum][this.columnNum] = 0;\r\n            if (this.typenum != -1) {\r\n                cc.ZL.targetMgr.clearTarget(this.node, this.typenum);\r\n            } else {\r\n                this.node.destroy();\r\n            }\r\n        }\r\n    }\r\n});\r\n"]}